"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8493],{"./src/stories/Feedback.stories.jsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,default:()=>Feedback_stories});var defineProperty=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),react=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),chunk_6CSUKJP7=__webpack_require__("./node_modules/@chakra-ui/layout/dist/chunk-6CSUKJP7.mjs"),asyncToGenerator=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),regenerator=__webpack_require__("./node_modules/@babel/runtime/regenerator/index.js"),regenerator_default=__webpack_require__.n(regenerator),chunk_MPFPK3CX=__webpack_require__("./node_modules/@chakra-ui/layout/dist/chunk-MPFPK3CX.mjs"),chunk_YTV6DHKL=__webpack_require__("./node_modules/@chakra-ui/layout/dist/chunk-YTV6DHKL.mjs"),useTranslation=__webpack_require__("./node_modules/next-translate/lib/esm/useTranslation.js"),prop_types=__webpack_require__("./node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),breathecode=__webpack_require__("./src/common/services/breathecode.js"),utils=__webpack_require__("./src/utils/index.js"),esm_extends=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/extends.js"),slicedToArray=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),objectWithoutProperties=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js"),chunk_ENIANY67=__webpack_require__("./node_modules/@chakra-ui/toast/dist/chunk-ENIANY67.mjs"),chunk_NAA7TEES=__webpack_require__("./node_modules/@chakra-ui/button/dist/chunk-NAA7TEES.mjs"),chunk_OEQDSMWZ=__webpack_require__("./node_modules/@chakra-ui/textarea/dist/chunk-OEQDSMWZ.mjs"),chunk_UUGUEMMH=__webpack_require__("./node_modules/@chakra-ui/modal/dist/chunk-UUGUEMMH.mjs"),chunk_OWW5MU75=__webpack_require__("./node_modules/@chakra-ui/modal/dist/chunk-OWW5MU75.mjs"),chunk_66WFFNY3=__webpack_require__("./node_modules/@chakra-ui/modal/dist/chunk-66WFFNY3.mjs"),chunk_YBA5A33G=__webpack_require__("./node_modules/@chakra-ui/modal/dist/chunk-YBA5A33G.mjs"),chunk_YLPWWAYV=__webpack_require__("./node_modules/@chakra-ui/modal/dist/chunk-YLPWWAYV.mjs"),chunk_PVJ72NKC=__webpack_require__("./node_modules/@chakra-ui/modal/dist/chunk-PVJ72NKC.mjs"),useStyle=__webpack_require__("./src/common/hooks/useStyle.js"),_excluded=["isOpen","title","leftButton","isCentered","children","onClose","maxWidth","bodyStyles","forceHandler","hideCloseButton","headerStyles","closeOnOverlayClick","onMouseUp","closeButtonStyles"],__jsx=react.createElement;function SimpleModal(_ref){var isOpen=_ref.isOpen,title=_ref.title,leftButton=_ref.leftButton,isCentered=_ref.isCentered,children=_ref.children,onClose=_ref.onClose,maxWidth=_ref.maxWidth,bodyStyles=_ref.bodyStyles,forceHandler=_ref.forceHandler,hideCloseButton=_ref.hideCloseButton,headerStyles=_ref.headerStyles,closeOnOverlayClick=_ref.closeOnOverlayClick,onMouseUp=_ref.onMouseUp,closeButtonStyles=_ref.closeButtonStyles,rest=(0,objectWithoutProperties.Z)(_ref,_excluded),_useStyle=(0,useStyle.Z)(),modal=_useStyle.modal,borderColor2=_useStyle.borderColor2;return __jsx(chunk_UUGUEMMH.u_,{isOpen,isCentered,onClose:function closeHandler(){forceHandler||onClose()},closeOnOverlayClick},__jsx(chunk_OWW5MU75.Z,null),__jsx(chunk_6CSUKJP7.xu,{onMouseUp},__jsx(chunk_66WFFNY3.h,(0,esm_extends.Z)({maxWidth,background:modal.background2,style:{marginTop:isCentered?"":"10vh"}},rest),leftButton&&leftButton,title&&__jsx(chunk_YBA5A33G.x,(0,esm_extends.Z)({borderBottom:1,borderStyle:"solid",borderColor:borderColor2},headerStyles),title),!hideCloseButton&&!forceHandler&&__jsx(chunk_YLPWWAYV.o,closeButtonStyles),__jsx(chunk_PVJ72NKC.f,bodyStyles,children))))}SimpleModal.displayName="SimpleModal",SimpleModal.propTypes={isOpen:prop_types_default().bool.isRequired,title:prop_types_default().oneOfType([prop_types_default().string,prop_types_default().node]),children:prop_types_default().node.isRequired,onClose:prop_types_default().func,maxWidth:prop_types_default().string,bodyStyles:prop_types_default().objectOf(prop_types_default().oneOfType([prop_types_default().string,prop_types_default().number])),forceHandler:prop_types_default().bool,hideCloseButton:prop_types_default().bool,headerStyles:prop_types_default().objectOf(prop_types_default().oneOfType([prop_types_default().string,prop_types_default().number])),closeOnOverlayClick:prop_types_default().bool,onMouseUp:prop_types_default().func,isCentered:prop_types_default().bool,leftButton:prop_types_default().node,closeButtonStyles:prop_types_default().objectOf(prop_types_default().oneOfType([prop_types_default().string,prop_types_default().number]))},SimpleModal.defaultProps={title:"",maxWidth:"780px",bodyStyles:{},forceHandler:!1,hideCloseButton:!1,onClose:function onClose(){},headerStyles:{},closeOnOverlayClick:!0,onMouseUp:function onMouseUp(){},isCentered:!1,leftButton:null,closeButtonStyles:{}},SimpleModal.__docgenInfo={description:"",methods:[],displayName:"SimpleModal",props:{title:{defaultValue:{value:"''",computed:!1},description:"",type:{name:"union",value:[{name:"string"},{name:"node"}]},required:!1},maxWidth:{defaultValue:{value:"'780px'",computed:!1},description:"",type:{name:"string"},required:!1},bodyStyles:{defaultValue:{value:"{}",computed:!1},description:"",type:{name:"objectOf",value:{name:"union",value:[{name:"string"},{name:"number"}]}},required:!1},forceHandler:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},hideCloseButton:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},onClose:{defaultValue:{value:"() => {}",computed:!1},description:"",type:{name:"func"},required:!1},headerStyles:{defaultValue:{value:"{}",computed:!1},description:"",type:{name:"objectOf",value:{name:"union",value:[{name:"string"},{name:"number"}]}},required:!1},closeOnOverlayClick:{defaultValue:{value:"true",computed:!1},description:"",type:{name:"bool"},required:!1},onMouseUp:{defaultValue:{value:"() => {}",computed:!1},description:"",type:{name:"func"},required:!1},isCentered:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},leftButton:{defaultValue:{value:"null",computed:!1},description:"",type:{name:"node"},required:!1},closeButtonStyles:{defaultValue:{value:"{}",computed:!1},description:"",type:{name:"objectOf",value:{name:"union",value:[{name:"string"},{name:"number"}]}},required:!1},isOpen:{description:"",type:{name:"bool"},required:!0},children:{description:"",type:{name:"node"},required:!0}}};const components_SimpleModal=SimpleModal;var Text=__webpack_require__("./src/common/components/Text.jsx"),toConsumableArray=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),chunk_YGVX4ESO=__webpack_require__("./node_modules/@chakra-ui/layout/dist/chunk-YGVX4ESO.mjs"),dynamic=__webpack_require__("./node_modules/next/dynamic.js"),dynamic_default=__webpack_require__.n(dynamic),Icon=__webpack_require__("./src/common/components/Icon/index.jsx"),Heading=(__webpack_require__("./node_modules/@uiw/react-markdown-editor/markdown-editor.css"),__webpack_require__("./node_modules/@uiw/react-markdown-preview/markdown.css"),__webpack_require__("./src/common/components/Heading.jsx")),MarkDownParser=__webpack_require__("./src/common/components/MarkDownParser/index.jsx"),console=__webpack_require__("./node_modules/console-browserify/index.js"),CodeReview_jsx=react.createElement;function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach((function(r){(0,defineProperty.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var MarkdownEditor=dynamic_default()((function(){return __webpack_require__.e(7318).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@uiw/react-markdown-editor/esm/index.js")).then((function(mod){return mod.default}))}),{ssr:!1,loadableGenerated:{webpack:function webpack(){return["./node_modules/@uiw/react-markdown-editor/esm/index.js"]}}}),views_initial="initial",views_started_revision="started_revision",views_success="success";function CodeReview(_ref){var _contextData$translat,_revisionContent$revi,_revisionContent$revi2,_storybookTranslation,_revisionContent$file,_storybookTranslation2,_storybookTranslation3,_storybookTranslation4,_storybookTranslation5,_storybookTranslation6,_storybookTranslation7,_storybookTranslation8,_storybookTranslation9,_contextData$translat2,isExternal=_ref.isExternal,onClose=_ref.onClose,disableRate=_ref.disableRate,isStudent=_ref.isStudent,handleResetFlow=_ref.handleResetFlow,contextData=_ref.contextData,setContextData=_ref.setContextData,setStage=_ref.setStage,selectedText=_ref.selectedText,handleSelectedText=_ref.handleSelectedText,t=(0,useTranslation.Z)("assignments").t,_useState=(0,react.useState)({}),repoData=_useState[0],setRepoData=_useState[1],_useState2=(0,react.useState)(views_initial),view=_useState2[0],setView=_useState2[1],_useState3=(0,react.useState)(!1),isLoading=_useState3[0],setIsLoading=_useState3[1],_useState4=(0,react.useState)({code:"",comment:"",isSubmitting:!1}),codeReview=_useState4[0],setCodeReview=_useState4[1],toast=(0,chunk_ENIANY67.p)(),hexColor=(0,useStyle.Z)().hexColor,_useState5=(0,react.useState)({status:null,comment:"",isSubmitting:!1,submited:!1,submitType:null}),reviewRateData=_useState5[0],setReviewRateData=_useState5[1],storybookTranslation=(null==contextData||null===(_contextData$translat=contextData.translation)||void 0===_contextData$translat?void 0:_contextData$translat.assignments)||{},commitData=null==contextData?void 0:contextData.commitFile,revisionContent=null==contextData?void 0:contextData.revision_content,hasRevision=void 0!==revisionContent,reviewRateStatus=null==reviewRateData?void 0:reviewRateData.status,myRevisions=(null==contextData?void 0:contextData.my_revisions)||[],reviewerName=(null==revisionContent||null===(_revisionContent$revi=revisionContent.reviewer)||void 0===_revisionContent$revi?void 0:_revisionContent$revi.name)||(null==revisionContent||null===(_revisionContent$revi2=revisionContent.reviewer)||void 0===_revisionContent$revi2?void 0:_revisionContent$revi2.username);(0,react.useEffect)((function(){!function prepareCommitData(){try{var _commitData$path,extensionLanguage=null==commitData||null===(_commitData$path=commitData.path)||void 0===_commitData$path?void 0:_commitData$path.split(".").pop().replace(/\?.*$/,""),codeRaw=commitData.code;setRepoData({raw:codeRaw,extensionLanguage,pathname:null==commitData?void 0:commitData.path,url:null==commitData?void 0:commitData.html_url,error:!1})}catch(error){console.error(error),setRepoData({msg:"No content found",error:!0})}}()}),[commitData]);var handleKeyUp=function handleKeyUp(){view===views_initial&&handleSelectedText()};(0,react.useEffect)((function(){return document.addEventListener("keyup",handleKeyUp),function(){document.removeEventListener("keyup",handleKeyUp)}}),[]);var goBack=function goBack(){isExternal&&reviewRateData.submited?onClose():(isStudent&&reviewRateData.submited&&function resetView(){setReviewRateData({status:null,comment:"",isSubmitting:!1,submited:!1,submitType:null}),setContextData((function(prevState){return _objectSpread(_objectSpread({},prevState),{},{revision_content:void 0})})),isStudent&&setStage("review_code_revision")}(),isStudent&&null!==reviewRateData.status&&setReviewRateData((function(prev){return _objectSpread(_objectSpread({},prev),{},{status:null,comment:""})})),null===reviewRateData.status&&(view===views_started_revision&&setView(views_initial),view!==views_started_revision&&(setStage(isStudent?"review_code_revision":"file_list"),setCodeReview({code:"",comments:""}),handleResetFlow())))},handleSelectReviewRate=function handleSelectReviewRate(status){setReviewRateData((function(prev){return _objectSpread(_objectSpread({},prev),{},{status})}))},onChangeRateComment=function onChangeRateComment(e){e.target.value.length<=100&&setReviewRateData((function(prev){return _objectSpread(_objectSpread({},prev),{},{comment:e.target.value})}))},submitReviewRate=function submitReviewRate(type){setReviewRateData((function(prev){return _objectSpread(_objectSpread({},prev),{},{isSubmitting:!0,submitType:type})}));var argsData={send:{is_good:"like"===reviewRateData.status,comment:reviewRateData.comment},skip:{is_good:"like"===reviewRateData.status,comment:null}};storybookTranslation?setReviewRateData((function(prev){return _objectSpread(_objectSpread({},prev),{},{submited:!0})})):breathecode.Z.assignments().rateCodeRevision(null==revisionContent?void 0:revisionContent.id,argsData[type]).then((function(_ref2){var respData=_ref2.data;setReviewRateData((function(prev){return _objectSpread(_objectSpread({},prev),{},{submited:!0})}));var updatedRevisionContent=_objectSpread(_objectSpread({},respData),{},{is_good:"string"==typeof(null==respData?void 0:respData.is_good)?"True"===(null==respData?void 0:respData.is_good):null==respData?void 0:respData.is_good,hasBeenReviewed:!0}),updateCodeRevisions=contextData.code_revisions.map((function(revision){return revision.id===revisionContent.id?updatedRevisionContent:revision}));setContextData((function(prevState){return _objectSpread(_objectSpread({},prevState),{},{code_revisions:updateCodeRevisions})}))})).finally((function(){setReviewRateData((function(prev){return _objectSpread(_objectSpread({},prev),{},{isSubmitting:!1})}))}))};return CodeReview_jsx(react.Fragment,null,CodeReview_jsx(chunk_6CSUKJP7.xu,{flex:.6,maxHeight:"76vh",overflow:"auto",onMouseUp:isStudent||view!==views_initial?function(){}:handleSelectedText},null!=repoData&&repoData.raw?CodeReview_jsx(MarkdownEditor,{readOnly:!0,className:"hide-preview",value:repoData.raw,width:"100%",style:{height:"auto",minWidth:"100%"},visible:!1,enableScroll:!0,renderPreview:function renderPreview(){return null},hideToolbar:!0,toolbars:[]}):"Loading..."),CodeReview_jsx(chunk_6CSUKJP7.xu,null,CodeReview_jsx(chunk_YGVX4ESO.i,{orientation:"vertical"})),CodeReview_jsx(chunk_6CSUKJP7.xu,{maxWidth:isStudent?"455px":"26.22rem",maxHeight:"76vh",overflow:"auto",flex:isStudent?.5:.4},view===views_success?CodeReview_jsx(chunk_MPFPK3CX.k,{flexDirection:"column",height:"100%",alignItems:"center",justifyContent:"center",gridGap:"24px"},CodeReview_jsx(Text.Z,{size:"26px",fontWeight:700,textAlign:"center",lineHeight:"34px"},t("code-review.code-review-successfully-sent")),CodeReview_jsx(Text.Z,{size:"18px"},t("code-review.submited-assignments-count",{count:null==myRevisions?void 0:myRevisions.length})),CodeReview_jsx(chunk_NAA7TEES.z,{variant:"default",gridGap:"10px",mt:"10px",onClick:goBack,fontSize:"13px",fontWeight:700,textTransform:"uppercase",width:"100%",height:"48px"},CodeReview_jsx(Icon.Z,{icon:"code-comment",size:"23px",color:"#fff"}),CodeReview_jsx(Text.Z,null,t("code-review.start-other-code-review")))):CodeReview_jsx(react.Fragment,null,view===views_initial&&!reviewRateData.submited&&null!==reviewRateStatus&&CodeReview_jsx(chunk_6CSUKJP7.xu,{mb:"1rem"},CodeReview_jsx(Icon.Z,{"aria-label":"Go back",icon:"arrowLeft",width:"24px",height:"16px",color:hexColor.black,onClick:goBack,cursor:"pointer"})),CodeReview_jsx(Heading.Z,{size:"sm",mb:isStudent?"3rem":"24px",textAlign:isStudent&&"center"},isStudent?(null==storybookTranslation||null===(_storybookTranslation=storybookTranslation["code-review"])||void 0===_storybookTranslation?void 0:_storybookTranslation["teacher-has-reviewed-your-code"].replace("{{name}}",reviewerName))||t("code-review.teacher-has-reviewed-your-code",{name:reviewerName}):t("code-review.code-review")),CodeReview_jsx(chunk_6CSUKJP7.xu,{padding:"9px 0",borderRadius:"8px",overflow:"auto"},!isStudent&&CodeReview_jsx(Text.Z,{fontSize:"14px",fontWeight:700,mb:"8px"},t("code-review.reviewing")),!isStudent&&CodeReview_jsx(chunk_MPFPK3CX.k,{gridGap:"10px",alignItems:"center",mb:"24px"},CodeReview_jsx(Icon.Z,{"aria-label":"Go back",icon:"arrowLeft",width:"17px",height:"11px",color:hexColor.black,onClick:goBack,cursor:"pointer"}),CodeReview_jsx(chunk_MPFPK3CX.k,{alignItems:"center",width:"100%",gridGap:"9px",padding:"9px 8px",border:"1px solid",borderColor:hexColor.borderColor,borderRadius:"8px"},CodeReview_jsx(Icon.Z,{icon:"folder",width:"14px",height:"14px",color:hexColor.black}),CodeReview_jsx(chunk_6CSUKJP7.xu,{minInlineSize:"max-content"},repoData.pathname))),view===views_initial&&!isStudent&&CodeReview_jsx(react.Fragment,null,CodeReview_jsx(chunk_MPFPK3CX.k,{gridGap:"15px",alignItems:"start"},(null==selectedText?void 0:selectedText.length)>0?CodeReview_jsx(Text.Z,{size:"14px"},t("code-review.selection-code-text")):CodeReview_jsx(react.Fragment,null,CodeReview_jsx(Icon.Z,{icon:"code-comment",size:"23px",color:hexColor.blueDefault,mt:"5px"}),CodeReview_jsx(Text.Z,{size:"18px"},t("code-review.use-your-mouse-to-select-code")))),(null==selectedText?void 0:selectedText.length)>0&&CodeReview_jsx(chunk_6CSUKJP7.xu,{fontSize:"13px",color:"#fff",mt:"2rem",padding:"6px 16px",borderRadius:"6px",whiteSpace:"pre-wrap",overflow:"auto",background:"rgb(45, 45, 45)",mb:"24px"},CodeReview_jsx(Text.Z,{fontSize:"18px",color:"#fff",fontWeight:700,mb:"14px"},t("code-review.you-selected-the-code")),CodeReview_jsx("pre",null,CodeReview_jsx("code",{className:"language-bash"},selectedText))),selectedText.length>0&&CodeReview_jsx(chunk_NAA7TEES.z,{variant:"default",gridGap:"10px",onClick:function startCodeReview(){var value=selectedText.replace(/[^\t\n\r\x20-\x7E\x80-\xBF\xC0-\xFD\xFE\xFF]/g,""),encodedText=btoa(value);setCodeReview({code:encodedText,comment:""}),setView(views_started_revision)},fontSize:"13px",fontWeight:700,textTransform:"uppercase",width:"100%",height:"48px"},CodeReview_jsx(Icon.Z,{icon:"code-comment",size:"23px",color:"#fff"}),CodeReview_jsx(Text.Z,null,t("code-review.start-code-review")))),view===views_initial&&isStudent&&!reviewRateData.submited&&CodeReview_jsx(chunk_MPFPK3CX.k,{flexDirection:"column",gridGap:"16px"},null===reviewRateStatus?CodeReview_jsx(react.Fragment,null,CodeReview_jsx(Text.Z,{size:"14px"},null==revisionContent?void 0:revisionContent.comment),CodeReview_jsx(chunk_6CSUKJP7.xu,{fontSize:"13px",color:"#fff",padding:"6px 16px",borderRadius:"6px",whiteSpace:"pre-wrap",overflow:"auto",background:"rgb(45, 45, 45)"},CodeReview_jsx(MarkDownParser.Z,{content:"```".concat(null==revisionContent||null===(_revisionContent$file=revisionContent.file)||void 0===_revisionContent$file?void 0:_revisionContent$file.language,"\n").concat(null==revisionContent?void 0:revisionContent.code,"\n```")}))):CodeReview_jsx(react.Fragment,null,CodeReview_jsx(Text.Z,{size:"14px",mb:"-6px"},(null==storybookTranslation||null===(_storybookTranslation2=storybookTranslation["code-review"])||void 0===_storybookTranslation2?void 0:_storybookTranslation2["write-comment"])||t("code-review.write-comment")),CodeReview_jsx(chunk_6CSUKJP7.xu,{position:"relative"},CodeReview_jsx(chunk_OEQDSMWZ.g,{value:null==reviewRateData?void 0:reviewRateData.comment,"aria-label":"feedback input",fontSize:"14px",onChange:onChangeRateComment,minHeight:"130px",placeholder:"Start you review here..."}),CodeReview_jsx(chunk_6CSUKJP7.xu,{position:"absolute",bottom:1.5,right:3,color:reviewRateData.comment.length<10?"yellow.default":"currentColor"},"".concat(reviewRateData.comment.length,"/ ").concat(100))),CodeReview_jsx(chunk_MPFPK3CX.k,{gridGap:"9px",mt:"0.7rem"},CodeReview_jsx(chunk_NAA7TEES.z,{flex:.7,variant:"default",isLoading:reviewRateData.isSubmitting&&"send"===reviewRateData.submitType,gridGap:"10px",isDisabled:reviewRateData.comment.length<10,onClick:function onClick(){return submitReviewRate("send")},fontSize:"13px",fontWeight:700,textTransform:"uppercase",width:"100%",height:"48px"},CodeReview_jsx(Text.Z,null,(null==storybookTranslation||null===(_storybookTranslation3=storybookTranslation["code-review"])||void 0===_storybookTranslation3?void 0:_storybookTranslation3.send)||t("code-review.send"))),CodeReview_jsx(chunk_NAA7TEES.z,{flex:.3,variant:"outline",isLoading:reviewRateData.isSubmitting&&"skip"===reviewRateData.submitType,borderColor:"blue.default",gridGap:"10px",onClick:function onClick(){return submitReviewRate("skip")},fontSize:"13px",fontWeight:700,textTransform:"uppercase",width:"100%",height:"48px"},CodeReview_jsx(Text.Z,{color:"blue.default"},(null==storybookTranslation||null===(_storybookTranslation4=storybookTranslation["code-review"])||void 0===_storybookTranslation4?void 0:_storybookTranslation4.skip)||t("code-review.skip"))))),!disableRate&&CodeReview_jsx(chunk_MPFPK3CX.k,{flexDirection:"column",gridGap:"24px",mt:"2rem"},!(null!=revisionContent&&revisionContent.hasBeenReviewed)&&CodeReview_jsx(react.Fragment,null,reviewRateStatus?CodeReview_jsx(chunk_YGVX4ESO.i,{margin:"18px 0 -8px 0"}):CodeReview_jsx(chunk_6CSUKJP7.xu,{fontSize:"18px",textAlign:"center"},(null==storybookTranslation||null===(_storybookTranslation5=storybookTranslation["code-review"])||void 0===_storybookTranslation5?void 0:_storybookTranslation5["did-feedback-useful"])||t("code-review.did-feedback-useful"))),CodeReview_jsx(chunk_6CSUKJP7.xu,{fontSize:"14px",textAlign:"center"},null===reviewRateStatus&&!(null!=revisionContent&&revisionContent.hasBeenReviewed)&&((null==storybookTranslation||null===(_storybookTranslation6=storybookTranslation["code-review"])||void 0===_storybookTranslation6?void 0:_storybookTranslation6["rate-comment"])||t("code-review.rate-comment")),("like"===reviewRateStatus||null===reviewRateStatus&&(null==revisionContent?void 0:revisionContent.is_good))&&((null==storybookTranslation||null===(_storybookTranslation7=storybookTranslation["code-review"])||void 0===_storybookTranslation7?void 0:_storybookTranslation7["you-liked-this-comment"])||t("code-review.you-liked-this-comment")),("dislike"===reviewRateStatus||null===reviewRateStatus&&!(null!=revisionContent&&revisionContent.is_good))&&((null==storybookTranslation||null===(_storybookTranslation8=storybookTranslation["code-review"])||void 0===_storybookTranslation8?void 0:_storybookTranslation8["you-disliked-this-comment"])||t("code-review.you-disliked-this-comment"))),CodeReview_jsx(chunk_MPFPK3CX.k,{justifyContent:"center",gridGap:"3.5rem"},CodeReview_jsx(chunk_NAA7TEES.z,{opacity:"dislike"!==reviewRateStatus&&null!=revisionContent&&revisionContent.hasBeenReviewed&&null!=revisionContent&&revisionContent.is_good||"like"===reviewRateStatus?1:.5,onClick:function onClick(){return handleSelectReviewRate("like")},variant:"unstyled",height:"auto",gridGap:"10px","aria-label":"Mark as Useful"},CodeReview_jsx(Icon.Z,{icon:"feedback-like",width:"54px",height:"54px"})),CodeReview_jsx(chunk_NAA7TEES.z,{opacity:"like"!==reviewRateStatus&&null!=revisionContent&&revisionContent.hasBeenReviewed&&!1===(null==revisionContent?void 0:revisionContent.is_good)||"dislike"===reviewRateStatus?1:.5,onClick:function onClick(){return handleSelectReviewRate("dislike")},variant:"unstyled",height:"auto",gridGap:"10px","aria-label":"Mark as not useful"},CodeReview_jsx(Icon.Z,{icon:"feedback-dislike",width:"54px",height:"54px"}))))),hasRevision&&reviewRateData.submited&&CodeReview_jsx(chunk_MPFPK3CX.k,{flexDirection:"column",gridGap:"16px"},CodeReview_jsx(chunk_MPFPK3CX.k,{flexDirection:"column",gridGap:"24px",borderRadius:"3px",alignItems:"center",background:"like"===reviewRateStatus?"green.light":"red.light2",padding:"16px 8px"},CodeReview_jsx(Icon.Z,{icon:"like"===reviewRateStatus?"feedback-like":"feedback-dislike",width:"60px",height:"60px"}),CodeReview_jsx(Text.Z,{size:"14px",fontWeight:700,textAlign:"center",color:"black"},(null==storybookTranslation||null===(_storybookTranslation9=storybookTranslation["code-review"])||void 0===_storybookTranslation9?void 0:_storybookTranslation9["comment-was-sent-successfully"])||t("code-review.comment-was-sent-successfully"))),(null==reviewRateData?void 0:reviewRateData.comment.length)>0&&"send"===(null==reviewRateData?void 0:reviewRateData.submitType)&&CodeReview_jsx(chunk_6CSUKJP7.xu,{position:"relative"},CodeReview_jsx(chunk_OEQDSMWZ.g,{readOnly:!0,opacity:.7,value:null==reviewRateData?void 0:reviewRateData.comment,"aria-label":"feedback input",fontSize:"12px",onChange:onChangeRateComment,minHeight:"130px",placeholder:""})),CodeReview_jsx(chunk_NAA7TEES.z,{variant:"outline",borderColor:"blue.default",color:"blue.default",onClick:goBack,fontSize:"17px",gridGap:"15px"},isExternal?(null==contextData||null===(_contextData$translat2=contextData.translation)||void 0===_contextData$translat2?void 0:_contextData$translat2.common.close)||t("common:close"):t("code-review.back-to-comments"))),view===views_started_revision&&CodeReview_jsx(chunk_MPFPK3CX.k,{flexDirection:"column",gridGap:"24px"},CodeReview_jsx(Text.Z,{size:"14px"},t("code-review.code-review-started-msg")," ",CodeReview_jsx(chunk_YTV6DHKL.r,{variant:"default",href:"/",fontSize:"14px",target:"_blank",rel:"noopener noreferer"},t("code-review.here")),"."),CodeReview_jsx(chunk_6CSUKJP7.xu,{position:"relative"},CodeReview_jsx(Text.Z,{fontSize:"14px",fontWeight:700,mb:"18px"},t("code-review.write-feedback-msg")),CodeReview_jsx(chunk_OEQDSMWZ.g,{value:codeReview.comment,"aria-label":"feedback input",fontSize:"12px",onChange:function onChangeCodeReview(e){e.target.value.length<=380&&setCodeReview((function(prev){return _objectSpread(_objectSpread({},prev),{},{comment:e.target.value})}))},minHeight:"134",placeholder:"Start you review here..."}),CodeReview_jsx(chunk_6CSUKJP7.xu,{position:"absolute",bottom:1.5,right:3,color:codeReview.comment.length<10?"#EB5757":"currentColor"},"".concat(codeReview.comment.length,"/ ").concat(380))),CodeReview_jsx(chunk_NAA7TEES.z,{variant:"default",isLoading,gridGap:"10px",isDisabled:codeReview.comment.length<10,onClick:function submitCodeReview(){var _commitData$committer;(setIsLoading(!0),setCodeReview((function(prev){return _objectSpread(_objectSpread({},prev),{},{isSubmitting:!0})})),codeReview.comment.length>=10)&&breathecode.Z.assignments().createCodeRevision(commitData.task.id,{commitfile_id:null==commitData?void 0:commitData.id,content_for_review:codeReview.code,comments:codeReview.comment,github_username:null==commitData||null===(_commitData$committer=commitData.committer)||void 0===_commitData$committer?void 0:_commitData$committer.github_username}).then((function(resp){var _resp$data$comment;(null===(_resp$data$comment=resp.data.comment)||void 0===_resp$data$comment?void 0:_resp$data$comment.length)>0&&(setContextData((function(prev){return _objectSpread(_objectSpread({},prev),{},{code_revisions:[].concat((0,toConsumableArray.Z)(prev.code_revisions),[resp.data]),my_revisions:[].concat((0,toConsumableArray.Z)(prev.my_revisions),[resp.data])})})),setView(views_success))})).catch((function(error){toast({title:t("alert-message:error-creating-code-review"),description:null==error?void 0:error.message,status:"error",duration:5e3,isClosable:!0})})).finally((function(){setCodeReview((function(prev){return _objectSpread(_objectSpread({},prev),{},{isSubmitting:!1})}))}))},fontSize:"13px",fontWeight:700,textTransform:"uppercase",width:"100%",height:"48px"},CodeReview_jsx(Icon.Z,{icon:"code-comment",size:"23px",color:codeReview.comment.length<10?"#606060":"#fff"}),CodeReview_jsx(Text.Z,null,t("code-review.submit-code-review"))))))))}CodeReview.propTypes={setStage:prop_types_default().func.isRequired,selectedText:prop_types_default().string,handleSelectedText:prop_types_default().func,contextData:prop_types_default().objectOf(prop_types_default().oneOfType([prop_types_default().any])).isRequired,setContextData:prop_types_default().func.isRequired,handleResetFlow:prop_types_default().func.isRequired,isStudent:prop_types_default().bool,disableRate:prop_types_default().bool,isExternal:prop_types_default().bool,onClose:prop_types_default().func.isRequired},CodeReview.defaultProps={selectedText:"",handleSelectedText:function handleSelectedText(){},isStudent:!1,disableRate:!1,isExternal:!1},CodeReview.__docgenInfo={description:"",methods:[],displayName:"CodeReview",props:{selectedText:{defaultValue:{value:"''",computed:!1},description:"",type:{name:"string"},required:!1},handleSelectedText:{defaultValue:{value:"() => {}",computed:!1},description:"",type:{name:"func"},required:!1},isStudent:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},disableRate:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},isExternal:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},setStage:{description:"",type:{name:"func"},required:!0},contextData:{description:"",type:{name:"objectOf",value:{name:"union",value:[{name:"any"}]}},required:!0},setContextData:{description:"",type:{name:"func"},required:!0},handleResetFlow:{description:"",type:{name:"func"},required:!0},onClose:{description:"",type:{name:"func"},required:!0}}};const ReviewModal_CodeReview=CodeReview;var AlertMessage=__webpack_require__("./src/common/components/AlertMessage.jsx"),logging=__webpack_require__("./src/utils/logging.js"),chunk_7NLW6UB6=__webpack_require__("./node_modules/@chakra-ui/color-mode/dist/chunk-7NLW6UB6.mjs"),chunk_YI7XFFAC=__webpack_require__("./node_modules/@chakra-ui/modal/dist/chunk-YI7XFFAC.mjs"),UndoApprovalModal_console=__webpack_require__("./node_modules/console-browserify/index.js"),UndoApprovalModal_jsx=react.createElement;function UndoApprovalModal_ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function UndoApprovalModal_objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?UndoApprovalModal_ownKeys(Object(t),!0).forEach((function(r){(0,defineProperty.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):UndoApprovalModal_ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function UndoApprovalModal(_ref){var _currentTask$user,_currentTask$user2,isOpen=_ref.isOpen,currentTask=_ref.currentTask,onSuccess=_ref.onSuccess,onClose=_ref.onClose,updpateAssignment=_ref.updpateAssignment,_useStyle=(0,useStyle.Z)(),modal=_useStyle.modal,borderColor2=_useStyle.borderColor2,_useState=(0,react.useState)(!1),isRequesting=_useState[0],setIsRequesting=_useState[1],labelColor=(0,chunk_7NLW6UB6.ff)("gray.600","gray.200"),t=(0,useTranslation.Z)("assignments").t,toast=(0,chunk_ENIANY67.p)(),fullName="".concat(null==currentTask||null===(_currentTask$user=currentTask.user)||void 0===_currentTask$user?void 0:_currentTask$user.first_name," ").concat(null==currentTask||null===(_currentTask$user2=currentTask.user)||void 0===_currentTask$user2?void 0:_currentTask$user2.last_name),taskIsIgnored="IGNORED"===(null==currentTask?void 0:currentTask.revision_status);return UndoApprovalModal_jsx(chunk_UUGUEMMH.u_,{isOpen,onClose,size:"lg"},UndoApprovalModal_jsx(chunk_OWW5MU75.Z,null),UndoApprovalModal_jsx(chunk_66WFFNY3.h,{background:modal.background2,borderRadius:"md",marginTop:"10%"},UndoApprovalModal_jsx(chunk_YBA5A33G.x,{fontSize:"15px",color:labelColor,textAlign:"center",letterSpacing:"0.05em",borderBottom:"1px solid",borderColor:borderColor2,fontWeight:"bold",textTransform:"uppercase"},t("deliver-assignment.title")),UndoApprovalModal_jsx(chunk_YLPWWAYV.o,null),UndoApprovalModal_jsx(chunk_PVJ72NKC.f,{pt:"2rem",pb:"2rem",px:{base:"20px",md:"15%"}},UndoApprovalModal_jsx(Text.Z,{fontSize:"22px",fontWeight:"700",textAlign:"center"},t("task-handler.confirm-undo",{student:fullName}))),UndoApprovalModal_jsx(chunk_YI7XFFAC.m,{margin:"0 1.5rem",padding:"1.5rem 0",justifyContent:"center",borderTop:"1px solid",borderColor:borderColor2},UndoApprovalModal_jsx(chunk_NAA7TEES.z,{isLoading:isRequesting,onClick:function onClick(){setIsRequesting(!0),breathecode.Z.todo().update({id:currentTask.id,revision_status:"PENDING",description:""}).then((function(){updpateAssignment(UndoApprovalModal_objectSpread(UndoApprovalModal_objectSpread({},currentTask),{},{id:currentTask.id,revision_status:"PENDING",description:""})),onSuccess(),onClose(),toast({position:"top",title:t("alert-message:review-assignment-updated"),status:"success",duration:5e3,isClosable:!0})})).catch((function(e){UndoApprovalModal_console.log(e),toast({position:"top",title:t("alert-message:review-assignment-error"),status:"error",duration:5e3,isClosable:!0})})).finally((function(){return setIsRequesting(!1)}))},variant:taskIsIgnored?"default":"outline",textTransform:"uppercase"},t("task-handler.undo-approval")))))}UndoApprovalModal.displayName="UndoApprovalModal",UndoApprovalModal.propTypes={isOpen:prop_types_default().bool.isRequired,onClose:prop_types_default().func.isRequired,currentTask:prop_types_default().objectOf(prop_types_default().oneOfType([prop_types_default().any])).isRequired,updpateAssignment:prop_types_default().func.isRequired,onSuccess:prop_types_default().func},UndoApprovalModal.defaultProps={onSuccess:function onSuccess(){}},UndoApprovalModal.__docgenInfo={description:"",methods:[],displayName:"UndoApprovalModal",props:{onSuccess:{defaultValue:{value:"() => {}",computed:!1},description:"",type:{name:"func"},required:!1},isOpen:{description:"",type:{name:"bool"},required:!0},onClose:{description:"",type:{name:"func"},required:!0},currentTask:{description:"",type:{name:"objectOf",value:{name:"union",value:[{name:"any"}]}},required:!0},updpateAssignment:{description:"",type:{name:"func"},required:!0}}};const components_UndoApprovalModal=UndoApprovalModal;var FileList_jsx=react.createElement;function FileList_ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function FileList_objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?FileList_ownKeys(Object(t),!0).forEach((function(r){(0,defineProperty.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):FileList_ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function FileList(_ref){var _data$task,isStudent=_ref.isStudent,currentTask=_ref.currentTask,contextData=_ref.contextData,updpateAssignment=_ref.updpateAssignment,setContextData=_ref.setContextData,stage=_ref.stage,stages=_ref.stages,setStage=_ref.setStage,setReviewStatus=_ref.setReviewStatus,t=(0,useTranslation.Z)("assignments").t,_useState=(0,react.useState)(!1),openUndoApproval=_useState[0],setOpenUndoApproval=_useState[1],_useStyle=(0,useStyle.Z)(),fontColor=_useStyle.fontColor,borderColor=_useStyle.borderColor,lightColor=_useStyle.lightColor,hexColor=_useStyle.hexColor,featuredLight=_useStyle.featuredLight,data=(null==contextData?void 0:contextData.commitFiles)||{},codeRevisions=(null==contextData?void 0:contextData.code_revisions)||[],fileList=(null==data?void 0:data.fileList)||[],hasBeenApproved="APPROVED"===(null==currentTask?void 0:currentTask.revision_status),buttonText={approve:t("review-assignment.approve"),reject:t("review-assignment.reject")},buttonColor={approve:"success",reject:"danger"};(0,logging.cM)("fileList:",fileList);var openCommitFile=function openCommitFile(commitData){!function proceedToCodeReview(commitData){var content=null==commitData?void 0:commitData.content;setContextData((function(prevState){return FileList_objectSpread(FileList_objectSpread({},prevState),{},{commitFile:FileList_objectSpread(FileList_objectSpread({path:null==commitData?void 0:commitData.name},commitData),{},{task:(null==data?void 0:data.task)||{},code:content})})})),setStage(stages.code_review)}(commitData)};return FileList_jsx(chunk_MPFPK3CX.k,{display:stage!==stages.file_list&&"none",flexDirection:"column",gridGap:"24px",width:"100%"},(null==fileList?void 0:fileList.length)>0?FileList_jsx(react.Fragment,null,FileList_jsx(chunk_MPFPK3CX.k,{mb:"15px",gridGap:"2px",flexDirection:"column"},FileList_jsx(Heading.Z,{size:"18px",color:lightColor,fontWeight:400},t("code-review.select-file-to-review")),FileList_jsx(Heading.Z,{size:"18px",fontWeight:700},null==data||null===(_data$task=data.task)||void 0===_data$task?void 0:_data$task.title)),FileList_jsx(chunk_MPFPK3CX.k,{my:"10px",py:"10px",px:"10px",borderRadius:"10px",background:featuredLight},FileList_jsx(chunk_6CSUKJP7.xu,{fontSize:"12px",flex:.33},t("code-review.filename")),FileList_jsx(chunk_6CSUKJP7.xu,{fontSize:"12px",flex:.33},t("code-review.feedback-status")),FileList_jsx(chunk_6CSUKJP7.xu,{fontSize:"12px",flex:.33},t("code-review.reviews"))),FileList_jsx(chunk_MPFPK3CX.k,{flexDirection:"column",gridGap:"12px"},fileList.map((function(file){var _file$committer,_file$committer2,revisionsRelated=(null==codeRevisions?void 0:codeRevisions.length)>0?codeRevisions.filter((function(revision){var _revision$file;return(null==revision||null===(_revision$file=revision.file)||void 0===_revision$file?void 0:_revision$file.id)===(null==file?void 0:file.id)})).sort((function(a,b){return new Date(b.updated_at)-new Date(a.updated_at)})):[],lastUpdatedRevision=(null==revisionsRelated?void 0:revisionsRelated[0])||{},feedbackHasBeenRated="boolean"==typeof(null==lastUpdatedRevision?void 0:lastUpdatedRevision.is_good),rateIcon=null!=lastUpdatedRevision&&lastUpdatedRevision.is_good?"feedback-like":"feedback-dislike";return FileList_jsx(chunk_MPFPK3CX.k,{border:"1px solid",borderColor,justifyContent:"center",alignItems:"center",height:"48px",padding:"4px 8px",borderRadius:"8px"},FileList_jsx(Icon.Z,{icon:"file2",width:"22px",height:"22px",display:"flex",alignItems:"center",color:fontColor,flex:.1}),FileList_jsx(chunk_MPFPK3CX.k,{flexDirection:"column",gridGap:"9px",flex:.4,maxWidth:"102px"},FileList_jsx(chunk_MPFPK3CX.k,{flexDirection:"column",gridGap:"0px"},FileList_jsx(Text.Z,{fontSize:"12px",fontWeight:700,style:{textWrap:"nowrap"}},null==file?void 0:file.name),FileList_jsx(Text.Z,{fontSize:"12px",fontWeight:400,title:null==file?void 0:file.commit_hash},"".concat(null==file?void 0:file.commit_hash.slice(0,10),"..."))),(null==file||null===(_file$committer=file.committer)||void 0===_file$committer?void 0:_file$committer.github_username)&&FileList_jsx(chunk_6CSUKJP7.xu,{fontSize:"12px"},null==file||null===(_file$committer2=file.committer)||void 0===_file$committer2?void 0:_file$committer2.github_username)),FileList_jsx(chunk_MPFPK3CX.k,{flex:.3,alignItems:"center",justifyContent:"center",opacity:null!==lastUpdatedRevision.is_good?1:.5},FileList_jsx(Icon.Z,{icon:feedbackHasBeenRated&&null!==lastUpdatedRevision.is_good?rateIcon:"unchecked",width:"24px",height:"24px"})),FileList_jsx(chunk_MPFPK3CX.k,{flex:.3,justifyContent:"center",alignItems:"center"},FileList_jsx(chunk_MPFPK3CX.k,{width:"auto",position:"relative",justifyContent:"center"},FileList_jsx(chunk_6CSUKJP7.xu,{position:"absolute",top:-1.5,right:-2,background:"blue.default",fontSize:"10px",padding:"1px 5px",fontWeight:700,height:"auto",borderRadius:"50%"},(null==revisionsRelated?void 0:revisionsRelated.length)||0),FileList_jsx(Icon.Z,{icon:"code-comment",width:"20px",height:"20px",color:hexColor.black}))),FileList_jsx(chunk_NAA7TEES.z,{variant:"default",isDisabled:!(null!=file&&file.content),flex:.2,height:"40px",onClick:function onClick(){null!=file&&file.content&&openCommitFile(file)},display:"flex",alignItems:"center",gridGap:"10px"},t("code-review.start-review")))})))):FileList_jsx(chunk_MPFPK3CX.k,{alignItems:"center",justifyContent:"center",padding:"0 0 1.5rem 0",height:"100%",width:"500px",flexDirection:"column",margin:"1rem auto",gridGap:"0.7rem"},FileList_jsx(Heading.Z,{size:"xsm"},t("code-review.no-files-to-review")),FileList_jsx(Text.Z,{size:"14px",textAlign:"center",style:{textWrap:"balance"}},t(hasBeenApproved?"code-review.student-has-no-files-but-has-been-approved":"code-review.student-has-no-files-to-review")),!hasBeenApproved&&FileList_jsx(chunk_MPFPK3CX.k,{width:"100%",justifyContent:"space-between",mt:"3rem"},["reject","approve"].map((function(type){return FileList_jsx(chunk_NAA7TEES.z,{minWidth:"128px",background:buttonColor[type],_hover:{background:buttonColor[type]},onClick:function onClick(){setStage(stages.approve_or_reject_code_revision),setReviewStatus(type)},color:"white",borderRadius:"3px",fontSize:"13px",textTransform:"uppercase"},buttonText[type])}))),!isStudent&&hasBeenApproved&&FileList_jsx(react.Fragment,null,FileList_jsx(chunk_NAA7TEES.z,{minWidth:"128px",mt:"8px",onClick:function onClick(){return setOpenUndoApproval(!0)},color:"currentColor",borderRadius:"3px",fontSize:"13px",textTransform:"uppercase",variant:"outline",width:"fit-content",alignSelf:"center"},t("task-handler.undo-approval")),FileList_jsx(components_UndoApprovalModal,{isOpen:openUndoApproval,onClose:function onClose(){return setOpenUndoApproval(!1)},updpateAssignment,currentTask}))))}FileList.displayName="FileList",FileList.propTypes={stage:prop_types_default().string,stages:prop_types_default().shape({initial:prop_types_default().string,file_list:prop_types_default().string,code_review:prop_types_default().string,approve_or_reject_code_revision:prop_types_default().string}),setStage:prop_types_default().func,contextData:prop_types_default().arrayOf(prop_types_default().oneOfType([prop_types_default().any])).isRequired,setContextData:prop_types_default().func,setReviewStatus:prop_types_default().func.isRequired,isStudent:prop_types_default().bool.isRequired,updpateAssignment:prop_types_default().func,currentTask:prop_types_default().objectOf(prop_types_default().oneOfType([prop_types_default().any])).isRequired},FileList.defaultProps={stage:"",stages:{initial:"initial",file_list:"file_list",code_review:"code_review"},setStage:function setStage(){},setContextData:function setContextData(){},updpateAssignment:function updpateAssignment(){}},FileList.__docgenInfo={description:"",methods:[],displayName:"FileList",props:{stage:{defaultValue:{value:"''",computed:!1},description:"",type:{name:"string"},required:!1},stages:{defaultValue:{value:"{\n  initial: 'initial',\n  file_list: 'file_list',\n  code_review: 'code_review',\n}",computed:!1},description:"",type:{name:"shape",value:{initial:{name:"string",required:!1},file_list:{name:"string",required:!1},code_review:{name:"string",required:!1},approve_or_reject_code_revision:{name:"string",required:!1}}},required:!1},setStage:{defaultValue:{value:"() => {}",computed:!1},description:"",type:{name:"func"},required:!1},setContextData:{defaultValue:{value:"() => {}",computed:!1},description:"",type:{name:"func"},required:!1},updpateAssignment:{defaultValue:{value:"() => {}",computed:!1},description:"",type:{name:"func"},required:!1},contextData:{description:"",type:{name:"arrayOf",value:{name:"union",value:[{name:"any"}]}},required:!0},setReviewStatus:{description:"",type:{name:"func"},required:!0},isStudent:{description:"",type:{name:"bool"},required:!0},currentTask:{description:"",type:{name:"objectOf",value:{name:"union",value:[{name:"any"}]}},required:!0}}};const ReviewModal_FileList=FileList;var LoaderScreen=__webpack_require__("./src/common/components/LoaderScreen.jsx"),ReviewCodeRevision_jsx=react.createElement;function ReviewCodeRevision_ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function ReviewCodeRevision_objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ReviewCodeRevision_ownKeys(Object(t),!0).forEach((function(r){(0,defineProperty.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ReviewCodeRevision_ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var defaultReviewRateData={status:null,comment:"",isSubmitting:!1,submited:!1,submitType:null,revision_rating:null};function ReviewCodeRevision(_ref){var _data$task,_revisionContent$file,_revisionContent$revi,_revisionContent$file2,_contextData$commitFi,_contextData$commitFi2,_contextData$commitFi3,_contextData$commitFi4,contextData=_ref.contextData,setContextData=_ref.setContextData,stages=_ref.stages,setStage=_ref.setStage,_useStyle=(0,useStyle.Z)(),fontColor=_useStyle.fontColor,borderColor=_useStyle.borderColor,lightColor=_useStyle.lightColor,hexColor=_useStyle.hexColor,featuredLight=_useStyle.featuredLight,_useState=(0,react.useState)(defaultReviewRateData),reviewRateData=_useState[0],setReviewRateData=_useState[1],t=(0,useTranslation.Z)("assignments").t,reviewRateStatus=null==reviewRateData?void 0:reviewRateData.status,data=(null==contextData?void 0:contextData.commitFiles)||{},codeRevisions=(null==contextData?void 0:contextData.code_revisions)||[],revisionContent=null==contextData?void 0:contextData.revision_content,hasRevision=void 0!==revisionContent,selectCodeRevision=function selectCodeRevision(revision){var _data$fileList,resetReviewRate=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],content=null==revision?void 0:revision.original_code,commitFile=(null==data||null===(_data$fileList=data.fileList)||void 0===_data$fileList?void 0:_data$fileList.length)>0?null==data?void 0:data.fileList.find((function(l){var _revision$file;return l.id===(null==revision||null===(_revision$file=revision.file)||void 0===_revision$file?void 0:_revision$file.id)})):{},decodedReviewCodeContent=atob(content);resetReviewRate&&setReviewRateData(defaultReviewRateData),setContextData((function(prevState){var _revision$file2;return ReviewCodeRevision_objectSpread(ReviewCodeRevision_objectSpread({},prevState),{},{commitFile:ReviewCodeRevision_objectSpread(ReviewCodeRevision_objectSpread({},commitFile),{},{task:(null==data?void 0:data.task)||{},code:null==commitFile?void 0:commitFile.content}),revision_content:ReviewCodeRevision_objectSpread(ReviewCodeRevision_objectSpread({path:null==revision||null===(_revision$file2=revision.file)||void 0===_revision$file2?void 0:_revision$file2.name},revision),{},{task:(null==data?void 0:data.task)||{},code:decodedReviewCodeContent})})}))};(0,react.useEffect)((function(){if((null==codeRevisions?void 0:codeRevisions.length)>0&&(null==revisionContent||!revisionContent.id)){var firstCodeRevision=(null==codeRevisions?void 0:codeRevisions[0])||{},hasBeenReviewed=(null==firstCodeRevision?void 0:firstCodeRevision.revision_rating)>0||null!==(null==firstCodeRevision?void 0:firstCodeRevision.revision_rating);selectCodeRevision(ReviewCodeRevision_objectSpread(ReviewCodeRevision_objectSpread({},firstCodeRevision),{},{revision_rating:null==firstCodeRevision?void 0:firstCodeRevision.revision_rating,hasBeenReviewed}))}}),[codeRevisions,revisionContent]);var handleSelectReviewRate=function handleSelectReviewRate(status){setReviewRateData((function(prev){return ReviewCodeRevision_objectSpread(ReviewCodeRevision_objectSpread({},prev),{},{status})}))},onChangeRateComment=function onChangeRateComment(e){e.target.value.length<=100&&setReviewRateData((function(prev){return ReviewCodeRevision_objectSpread(ReviewCodeRevision_objectSpread({},prev),{},{comment:e.target.value})}))},submitReviewRate=function submitReviewRate(type){setReviewRateData((function(prev){return ReviewCodeRevision_objectSpread(ReviewCodeRevision_objectSpread({},prev),{},{isSubmitting:!0,submitType:type})}));var argsData={send:{is_good:"like"===reviewRateData.status,comment:reviewRateData.comment},skip:{is_good:"like"===reviewRateData.status,comment:null}};breathecode.Z.assignments().rateCodeRevision(null==revisionContent?void 0:revisionContent.id,argsData[type]).then((function(_ref2){var respData=_ref2.data;setReviewRateData((function(prev){return ReviewCodeRevision_objectSpread(ReviewCodeRevision_objectSpread({},prev),{},{submited:!0})}));var updatedRevisionContent=ReviewCodeRevision_objectSpread(ReviewCodeRevision_objectSpread({},respData),{},{is_good:"string"==typeof(null==respData?void 0:respData.is_good)?"True"===(null==respData?void 0:respData.is_good):null==respData?void 0:respData.is_good,hasBeenReviewed:!0}),updateCodeRevisions=contextData.code_revisions.map((function(revision){return revision.id===revisionContent.id?updatedRevisionContent:revision}));selectCodeRevision(updatedRevisionContent,!1),setContextData((function(prevState){return ReviewCodeRevision_objectSpread(ReviewCodeRevision_objectSpread({},prevState),{},{code_revisions:updateCodeRevisions})}))})).finally((function(){setReviewRateData((function(prev){return ReviewCodeRevision_objectSpread(ReviewCodeRevision_objectSpread({},prev),{},{isSubmitting:!1})}))}))};return ReviewCodeRevision_jsx(chunk_MPFPK3CX.k,{flexDirection:"row",height:"30rem",justifyContent:"center",gridGap:"6px",width:"100%",maxHeight:reviewRateStatus?"auto":"30rem"},(null==codeRevisions?void 0:codeRevisions.length)>0?ReviewCodeRevision_jsx(react.Fragment,null,ReviewCodeRevision_jsx(chunk_6CSUKJP7.xu,{width:"100%",flex:.65},ReviewCodeRevision_jsx(chunk_MPFPK3CX.k,{mb:"15px",gridGap:"2px",flexDirection:"column"},ReviewCodeRevision_jsx(Heading.Z,{size:"18px",color:lightColor,fontWeight:400},t("code-review.select-file-to-review")),ReviewCodeRevision_jsx(Heading.Z,{size:"18px",fontWeight:700},null==data||null===(_data$task=data.task)||void 0===_data$task?void 0:_data$task.title)),ReviewCodeRevision_jsx(chunk_MPFPK3CX.k,{my:"10px",py:"10px",px:"10px",borderRadius:"10px",background:featuredLight},ReviewCodeRevision_jsx(chunk_6CSUKJP7.xu,{fontSize:"12px",flex:.33},t("code-review.filename")),ReviewCodeRevision_jsx(chunk_6CSUKJP7.xu,{fontSize:"12px",flex:.33,textAlign:"center"},t("code-review.feedback-status"))),ReviewCodeRevision_jsx(chunk_MPFPK3CX.k,{overflow:"auto",height:"24rem",py:"0.5rem",flexDirection:"column",gridGap:"12px"},(null==codeRevisions?void 0:codeRevisions.length)>0&&codeRevisions.map((function(commit){var _commit$file,_commit$file2,_commit$file3,_commit$committer,_commit$committer2,isSelected=(null==revisionContent?void 0:revisionContent.id)===(null==commit?void 0:commit.id),hasBeenReviewed="boolean"==typeof(null==commit?void 0:commit.is_good),dataStruct=ReviewCodeRevision_objectSpread(ReviewCodeRevision_objectSpread({},commit),{},{revision_rating:null==commit?void 0:commit.revision_rating,hasBeenReviewed});return ReviewCodeRevision_jsx(chunk_MPFPK3CX.k,{cursor:"pointer",onClick:function onClick(){return selectCodeRevision(dataStruct)},_hover:{background:featuredLight},border:"1px solid",borderColor:isSelected?"blue.default":borderColor,justifyContent:"space-between",alignItems:"center",height:"48px",padding:"4px 8px",borderRadius:"8px"},ReviewCodeRevision_jsx(chunk_MPFPK3CX.k,{flex:.3,gridGap:"10px"},ReviewCodeRevision_jsx(Icon.Z,{icon:"file2",width:"22px",height:"22px",display:"flex",alignItems:"center",color:fontColor}),ReviewCodeRevision_jsx(chunk_MPFPK3CX.k,{flexDirection:"column",justifyContent:"center",gridGap:"9px",maxWidth:"102px"},ReviewCodeRevision_jsx(chunk_MPFPK3CX.k,{flexDirection:"column",gridGap:"0px"},ReviewCodeRevision_jsx(Text.Z,{fontSize:"12px",fontWeight:700,style:{textWrap:"nowrap"}},null==commit||null===(_commit$file=commit.file)||void 0===_commit$file?void 0:_commit$file.name),ReviewCodeRevision_jsx(Text.Z,{fontSize:"12px",fontWeight:400,title:null==commit||null===(_commit$file2=commit.file)||void 0===_commit$file2?void 0:_commit$file2.commit_hash},"".concat(null==commit||null===(_commit$file3=commit.file)||void 0===_commit$file3?void 0:_commit$file3.commit_hash.slice(0,10),"..."))),(null==commit||null===(_commit$committer=commit.committer)||void 0===_commit$committer?void 0:_commit$committer.github_username)&&ReviewCodeRevision_jsx(chunk_6CSUKJP7.xu,{fontSize:"12px"},null==commit||null===(_commit$committer2=commit.committer)||void 0===_commit$committer2?void 0:_commit$committer2.github_username))),ReviewCodeRevision_jsx(chunk_MPFPK3CX.k,{flex:.3,justifyContent:"center",alignItems:"center"},ReviewCodeRevision_jsx(chunk_MPFPK3CX.k,{width:"auto",position:"relative",justifyContent:"center"},ReviewCodeRevision_jsx(chunk_6CSUKJP7.xu,{position:"absolute",top:-1.5,right:-2,background:hasBeenReviewed?"success":"yellow.default",fontSize:"10px",padding:"3px",fontWeight:700,height:"auto",borderRadius:"50%"},ReviewCodeRevision_jsx(Icon.Z,{icon:hasBeenReviewed?"verified2":"asterisk",width:"8px",height:"8px"})),ReviewCodeRevision_jsx(Icon.Z,{icon:"code-comment",width:"20px",height:"20px",color:hexColor.black}))),ReviewCodeRevision_jsx(chunk_NAA7TEES.z,{variant:"link",flex:.3,height:"40px",onClick:function onClick(){return selectCodeRevision(dataStruct)},display:"flex",width:"fit-content",justifyContent:"flex-end",alignItems:"center",padding:"0 1rem 0 0",gridGap:"10px"},t("code-review.review")))})))),(null==revisionContent?void 0:revisionContent.id)&&ReviewCodeRevision_jsx(chunk_MPFPK3CX.k,{flexDirection:"column",overflow:"auto",gridGap:"12px",flex:.35,width:"100%",padding:"8px",mt:!hasRevision&&"3.4rem"},ReviewCodeRevision_jsx(chunk_6CSUKJP7.xu,{fontSize:"14px",fontWeight:700,letterSpacing:"0.08em"},null==revisionContent||null===(_revisionContent$file=revisionContent.file)||void 0===_revisionContent$file?void 0:_revisionContent$file.name),ReviewCodeRevision_jsx(chunk_YGVX4ESO.i,null),hasRevision&&!reviewRateData.submited&&ReviewCodeRevision_jsx(chunk_MPFPK3CX.k,{flexDirection:"column",gridGap:"16px"},null===reviewRateStatus?ReviewCodeRevision_jsx(react.Fragment,null,ReviewCodeRevision_jsx(chunk_MPFPK3CX.k,{flexDirection:"column",gridGap:"8px"},ReviewCodeRevision_jsx(Heading.Z,{fontSize:"12px",fontWeight:700},t("code-review.person-has-commented",{name:null==revisionContent||null===(_revisionContent$revi=revisionContent.reviewer)||void 0===_revisionContent$revi?void 0:_revisionContent$revi.name})),ReviewCodeRevision_jsx(Text.Z,{size:"12px"},null==revisionContent?void 0:revisionContent.comment),ReviewCodeRevision_jsx(chunk_6CSUKJP7.xu,{fontSize:"13px",color:"#fff",borderRadius:"6px",whiteSpace:"pre-wrap",overflow:"auto"},ReviewCodeRevision_jsx(MarkDownParser.Z,{content:"```".concat((null==revisionContent||null===(_revisionContent$file2=revisionContent.file)||void 0===_revisionContent$file2?void 0:_revisionContent$file2.language)||"bash","\n").concat(null==revisionContent?void 0:revisionContent.code,"\n```")}))),ReviewCodeRevision_jsx(chunk_NAA7TEES.z,{isDisabled:!(null!==(_contextData$commitFi=contextData.commitFile)&&void 0!==_contextData$commitFi&&_contextData$commitFi.id),onClick:function onClick(){return setStage(stages.code_review)},color:!(null!==(_contextData$commitFi2=contextData.commitFile)&&void 0!==_contextData$commitFi2&&_contextData$commitFi2.id)&&"white",variant:"link",fontSize:"17px",gridGap:"15px"},(null===(_contextData$commitFi3=contextData.commitFile)||void 0===_contextData$commitFi3?void 0:_contextData$commitFi3.id)&&ReviewCodeRevision_jsx(Icon.Z,{icon:"longArrowRight",width:"20px",height:"20px",color:hexColor.blueDefault}),null!==(_contextData$commitFi4=contextData.commitFile)&&void 0!==_contextData$commitFi4&&_contextData$commitFi4.id?t("code-review.go-to-review"):"No commit file found"),ReviewCodeRevision_jsx(chunk_YGVX4ESO.i,{mt:"-8px"})):ReviewCodeRevision_jsx(react.Fragment,null,ReviewCodeRevision_jsx(Text.Z,{size:"14px",mb:"-6px"},t("code-review.write-comment")),ReviewCodeRevision_jsx(chunk_6CSUKJP7.xu,{position:"relative"},ReviewCodeRevision_jsx(chunk_OEQDSMWZ.g,{value:null==reviewRateData?void 0:reviewRateData.comment,"aria-label":"feedback input",fontSize:"12px",onChange:onChangeRateComment,minHeight:"130px",placeholder:t("code-review.start-review-here")}),ReviewCodeRevision_jsx(chunk_6CSUKJP7.xu,{position:"absolute",bottom:1.5,right:3,color:reviewRateData.comment.length<10?"yellow.default":"currentColor"},"".concat(reviewRateData.comment.length,"/ ").concat(100))),ReviewCodeRevision_jsx(chunk_MPFPK3CX.k,{gridGap:"9px",mt:"0.7rem"},ReviewCodeRevision_jsx(chunk_NAA7TEES.z,{flex:.7,variant:"default",isLoading:reviewRateData.isSubmitting&&"send"===reviewRateData.submitType,gridGap:"10px",isDisabled:reviewRateData.comment.length<10,onClick:function onClick(){return submitReviewRate("send")},fontSize:"13px",fontWeight:700,textTransform:"uppercase",width:"100%",height:"48px"},ReviewCodeRevision_jsx(Text.Z,null,t("code-review.send"))),ReviewCodeRevision_jsx(chunk_NAA7TEES.z,{flex:.3,variant:"outline",isLoading:reviewRateData.isSubmitting&&"skip"===reviewRateData.submitType,borderColor:"blue.default",gridGap:"10px",onClick:function onClick(){return submitReviewRate("skip")},fontSize:"13px",fontWeight:700,textTransform:"uppercase",width:"100%",height:"48px"},ReviewCodeRevision_jsx(Text.Z,{color:"blue.default"},t("code-review.skip"))))),ReviewCodeRevision_jsx(chunk_MPFPK3CX.k,{flexDirection:"column",gridGap:"24px"},reviewRateStatus&&ReviewCodeRevision_jsx(chunk_YGVX4ESO.i,{margin:"18px 0 -8px 0"}),ReviewCodeRevision_jsx(chunk_6CSUKJP7.xu,{fontSize:"14px",textAlign:"center"},null===reviewRateStatus&&!(null!=revisionContent&&revisionContent.hasBeenReviewed)&&t("code-review.rate-comment"),("like"===reviewRateStatus||null===reviewRateStatus&&(null==revisionContent?void 0:revisionContent.is_good))&&t("code-review.you-liked-this-comment"),("dislike"===reviewRateStatus||null===reviewRateStatus&&!(null!=revisionContent&&revisionContent.is_good))&&t("code-review.you-disliked-this-comment")),ReviewCodeRevision_jsx(chunk_MPFPK3CX.k,{justifyContent:"center",gridGap:"3.5rem"},ReviewCodeRevision_jsx(chunk_NAA7TEES.z,{opacity:"dislike"!==reviewRateStatus&&null!=revisionContent&&revisionContent.hasBeenReviewed&&null!=revisionContent&&revisionContent.is_good||"like"===reviewRateStatus?1:.5,onClick:function onClick(){return handleSelectReviewRate("like")},variant:"unstyled",height:"auto",gridGap:"10px","aria-label":"Mark as Useful"},ReviewCodeRevision_jsx(Icon.Z,{icon:"feedback-like",width:"54px",height:"54px"})),ReviewCodeRevision_jsx(chunk_NAA7TEES.z,{opacity:"like"!==reviewRateStatus&&null!=revisionContent&&revisionContent.hasBeenReviewed&&!1===(null==revisionContent?void 0:revisionContent.is_good)||"dislike"===reviewRateStatus?1:.5,onClick:function onClick(){return handleSelectReviewRate("dislike")},variant:"unstyled",height:"auto",gridGap:"10px","aria-label":"Mark as not useful"},ReviewCodeRevision_jsx(Icon.Z,{icon:"feedback-dislike",width:"54px",height:"54px"}))))),hasRevision&&reviewRateData.submited&&ReviewCodeRevision_jsx(chunk_MPFPK3CX.k,{flexDirection:"column",gridGap:"16px"},ReviewCodeRevision_jsx(chunk_MPFPK3CX.k,{flexDirection:"column",gridGap:"24px",borderRadius:"3px",alignItems:"center",background:"like"===reviewRateStatus?"green.light":"red.light2",padding:"16px 8px"},ReviewCodeRevision_jsx(Icon.Z,{icon:"like"===reviewRateStatus?"feedback-like":"feedback-dislike",width:"60px",height:"60px"}),ReviewCodeRevision_jsx(Text.Z,{size:"14px",fontWeight:700,textAlign:"center",color:"black"},t("code-review.comment-was-sent-successfully"))),(null==reviewRateData?void 0:reviewRateData.comment.length)>0&&"send"===(null==reviewRateData?void 0:reviewRateData.submitType)&&ReviewCodeRevision_jsx(chunk_6CSUKJP7.xu,{position:"relative"},ReviewCodeRevision_jsx(chunk_OEQDSMWZ.g,{readOnly:!0,opacity:.7,value:null==reviewRateData?void 0:reviewRateData.comment,"aria-label":"feedback input",fontSize:"12px",onChange:onChangeRateComment,minHeight:"130px",placeholder:""})),ReviewCodeRevision_jsx(chunk_NAA7TEES.z,{variant:"outline",borderColor:"blue.default",color:"blue.default",onClick:function goBack(){reviewRateData.submited&&function resetView(){setReviewRateData({status:null,comment:"",isSubmitting:!1,submited:!1,submitType:null})}(),null!==reviewRateData.status?setReviewRateData((function(prev){return ReviewCodeRevision_objectSpread(ReviewCodeRevision_objectSpread({},prev),{},{status:null,comment:""})})):setContextData((function(prevState){return ReviewCodeRevision_objectSpread(ReviewCodeRevision_objectSpread({},prevState),{},{revision_content:void 0})}))},fontSize:"17px",gridGap:"15px"},t("code-review.back-to-comments"))))):ReviewCodeRevision_jsx(chunk_MPFPK3CX.k,{alignItems:"center",flexDirection:"column",my:"4rem",gridGap:"0.7rem"},ReviewCodeRevision_jsx(Heading.Z,{size:"xsm"},t("code-review.no-files-to-review")),ReviewCodeRevision_jsx(Text.Z,{size:"14px"},t("code-review.teacher-has-not-reviewed-files"))))}ReviewCodeRevision.displayName="ReviewCodeRevision",ReviewCodeRevision.propTypes={stages:prop_types_default().shape({initial:prop_types_default().string,file_list:prop_types_default().string,code_review:prop_types_default().string,review_code_revision:prop_types_default().string}),setStage:prop_types_default().func,contextData:prop_types_default().arrayOf(prop_types_default().oneOfType([prop_types_default().any])).isRequired,setContextData:prop_types_default().func},ReviewCodeRevision.defaultProps={stages:{initial:"initial",file_list:"file_list",code_review:"code_review",review_code_revision:"review_code_revision"},setStage:function setStage(){},setContextData:function setContextData(){}},ReviewCodeRevision.__docgenInfo={description:"",methods:[],displayName:"ReviewCodeRevision",props:{stages:{defaultValue:{value:"{\n  initial: 'initial',\n  file_list: 'file_list',\n  code_review: 'code_review',\n  review_code_revision: 'review_code_revision',\n}",computed:!1},description:"",type:{name:"shape",value:{initial:{name:"string",required:!1},file_list:{name:"string",required:!1},code_review:{name:"string",required:!1},review_code_revision:{name:"string",required:!1}}},required:!1},setStage:{defaultValue:{value:"() => {}",computed:!1},description:"",type:{name:"func"},required:!1},setContextData:{defaultValue:{value:"() => {}",computed:!1},description:"",type:{name:"func"},required:!1},contextData:{description:"",type:{name:"arrayOf",value:{name:"union",value:[{name:"any"}]}},required:!0}}};const ReviewModal_ReviewCodeRevision=ReviewCodeRevision;var usePersistent=__webpack_require__("./src/common/hooks/usePersistent.js"),chunk_4OGHDZEB=__webpack_require__("./node_modules/@chakra-ui/popover/dist/chunk-4OGHDZEB.mjs"),chunk_3O5UWOX6=__webpack_require__("./node_modules/@chakra-ui/popover/dist/chunk-3O5UWOX6.mjs"),chunk_KVBLLJMP=__webpack_require__("./node_modules/@chakra-ui/popover/dist/chunk-KVBLLJMP.mjs"),chunk_6YK4VVQO=__webpack_require__("./node_modules/@chakra-ui/popover/dist/chunk-6YK4VVQO.mjs"),chunk_BYOOQOH2=__webpack_require__("./node_modules/@chakra-ui/popover/dist/chunk-BYOOQOH2.mjs"),chunk_THJVJMZP=__webpack_require__("./node_modules/@chakra-ui/popover/dist/chunk-THJVJMZP.mjs"),chunk_3JH7ZFSI=__webpack_require__("./node_modules/@chakra-ui/popover/dist/chunk-3JH7ZFSI.mjs"),chunk_P74GIWPW=__webpack_require__("./node_modules/@chakra-ui/layout/dist/chunk-P74GIWPW.mjs"),chunk_6ZNYZUDD=__webpack_require__("./node_modules/@chakra-ui/form-control/dist/chunk-6ZNYZUDD.mjs"),chunk_GYFRIY2Z=__webpack_require__("./node_modules/@chakra-ui/input/dist/chunk-GYFRIY2Z.mjs"),chunk_3GP7MWMA=__webpack_require__("./node_modules/@chakra-ui/form-control/dist/chunk-3GP7MWMA.mjs"),index_esm=__webpack_require__("./node_modules/yup/index.esm.js"),formik_esm=__webpack_require__("./node_modules/formik/dist/formik.esm.js"),iconDict=__webpack_require__("./src/common/utils/iconDict.json"),regex=__webpack_require__("./src/utils/regex.js"),PopoverTaskHandler_jsx=react.createElement;function TextByTaskStatus(_ref){var currentTask=_ref.currentTask,t=_ref.t,taskIsApproved="APPROVED"===(null==currentTask?void 0:currentTask.revision_status);return currentTask&&"PROJECT"===currentTask.task_type&&currentTask.task_status?"DONE"===currentTask.task_status&&"PENDING"===currentTask.revision_status?PopoverTaskHandler_jsx(react.Fragment,null,PopoverTaskHandler_jsx(Icon.Z,{icon:"checked",color:"#FFB718",width:"20px",height:"20px"}),t("common:taskStatus.update-project-delivery")):"APPROVED"===currentTask.revision_status?PopoverTaskHandler_jsx(react.Fragment,null,PopoverTaskHandler_jsx(Icon.Z,{icon:"verified",color:"#606060",width:"20px"}),t("common:taskStatus.project-approved")):"REJECTED"===currentTask.revision_status?PopoverTaskHandler_jsx(react.Fragment,null,PopoverTaskHandler_jsx(Icon.Z,{icon:"checked",color:"#FF4433",width:"20px"}),t("common:taskStatus.update-project-delivery")):PopoverTaskHandler_jsx(react.Fragment,null,PopoverTaskHandler_jsx(Icon.Z,{icon:"unchecked",color:"#C4C4C4",width:"20px"}),t("common:taskStatus.send-project")):currentTask&&"PROJECT"!==currentTask.task_type&&"DONE"===currentTask.task_status?PopoverTaskHandler_jsx(react.Fragment,null,PopoverTaskHandler_jsx(Icon.Z,{icon:"close",color:"#FFFFFF",width:"12px"}),t("common:taskStatus.mark-as-not-done")):PopoverTaskHandler_jsx(react.Fragment,null,PopoverTaskHandler_jsx(Icon.Z,{icon:"checked2",color:taskIsApproved?"#606060":"#FFFFFF",width:"14px"}),t("common:taskStatus.mark-as-done"))}function IconByTaskStatus(_ref2){var currentTask=_ref2.currentTask,hasDeliveryFormat=!_ref2.noDeliveryFormat;return currentTask&&"PROJECT"===currentTask.task_type&&currentTask.task_status?"DONE"===currentTask.task_status&&"PENDING"===currentTask.revision_status&&hasDeliveryFormat?PopoverTaskHandler_jsx(Icon.Z,{icon:"checked",color:"#FFB718",width:"27px",height:"27px"}):"DONE"!==currentTask.task_status||"PENDING"!==currentTask.revision_status||hasDeliveryFormat?"APPROVED"===currentTask.revision_status?PopoverTaskHandler_jsx(Icon.Z,{icon:"verified",color:"#25BF6C",width:"27px"}):"REJECTED"===currentTask.revision_status?PopoverTaskHandler_jsx(Icon.Z,{icon:"checked",color:"#FF4433",width:"27px"}):PopoverTaskHandler_jsx(Icon.Z,{icon:"unchecked",color:"#C4C4C4",width:"27px"}):PopoverTaskHandler_jsx(Icon.Z,{icon:"verified",color:"#25BF6C",width:"27px"}):currentTask&&"PROJECT"!==currentTask.task_type&&"DONE"===currentTask.task_status?PopoverTaskHandler_jsx(Icon.Z,{icon:"verified",color:"#25BF6C",width:"27px"}):PopoverTaskHandler_jsx(Icon.Z,{icon:"unchecked",color:"#C4C4C4",width:"27px"})}function PopoverTaskHandler(_ref3){var _currentAssetData$del3,_currentAssetData$del4,isLoading=_ref3.isLoading,currentAssetData=_ref3.currentAssetData,currentTask=_ref3.currentTask,sendProject=_ref3.sendProject,onClickHandler=_ref3.onClickHandler,settingsOpen=_ref3.settingsOpen,allowText=_ref3.allowText,closeSettings=_ref3.closeSettings,toggleSettings=_ref3.toggleSettings,buttonChildren=_ref3.buttonChildren,t=(0,useTranslation.Z)("dashboard").t,_usePersistent=(0,usePersistent.K)("cohortSession",{}),cohortSession=(0,slicedToArray.Z)(_usePersistent,1)[0],_useState=(0,react.useState)(!1),isSubmitting=_useState[0],setIsSubmitting=_useState[1],_useState2=(0,react.useState)(""),githubUrl=_useState2[0],setGithubUrl=_useState2[1],_useState3=(0,react.useState)(!1),isUploading=_useState3[0],setIsUploading=_useState3[1],_useState4=(0,react.useState)(!1),dragOver=_useState4[0],setDragOver=_useState4[1],_useState5=(0,react.useState)([]),fileProps=_useState5[0],setFileProps=_useState5[1],_useStyle=(0,useStyle.Z)(),featuredColor=_useStyle.featuredColor,lightColor=_useStyle.lightColor,modal=_useStyle.modal,hexColor=_useStyle.hexColor,fileInputRef=(0,react.useRef)(),fileContainerRef=(0,react.useRef)(null),commonInputActiveColor=(0,chunk_7NLW6UB6.ff)("gray.800","gray.350"),toast=(0,chunk_ENIANY67.p)(),taskIsApproved=allowText&&"APPROVED"===(null==currentTask?void 0:currentTask.revision_status),deliveryFormatExists="string"==typeof(null==currentAssetData?void 0:currentAssetData.delivery_formats),noDeliveryFormat=deliveryFormatExists&&(null==currentAssetData?void 0:currentAssetData.delivery_formats.includes("no_delivery")),deliveryFormatIsUrl=deliveryFormatExists&&(null==currentAssetData?void 0:currentAssetData.delivery_formats.includes("url")),regexUrlExists="string"==typeof(null==currentAssetData?void 0:currentAssetData.delivery_regex_url),mimeTypes=(null==currentAssetData?void 0:currentAssetData.delivery_formats)||"application/pdf,image/png,image/jpeg,image/jpg,image/gif",fileErrorExists=fileProps.some((function(file){return file.formatError}))||fileProps.some((function(file){return file.sizeError})),isButtonDisabled=null===currentTask||taskIsApproved,customUrlValidation=index_esm.Ry().shape({githubUrl:index_esm.Z_().matches(null==currentAssetData?void 0:currentAssetData.delivery_regex_url,t("deliverProject.invalid-url",{url:null==currentAssetData?void 0:currentAssetData.delivery_regex_url})).required(t("deliverProject.url-is-required"))}),githubUrlValidation=index_esm.Ry().shape({githubUrl:index_esm.Z_().matches(regex.bW,t("deliverProject.invalid-url",{url:"https://github.com/"})).required(t("deliverProject.url-is-required"))}),fileSumSize=fileProps.reduce((function(acc,_ref4){return acc+_ref4.file.size}),0),handleUploadFile=function(){var _ref5=(0,asyncToGenerator.Z)(regenerator_default().mark((function _callee(){var formdata,resp,respData;return regenerator_default().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return setIsUploading(!0),formdata=new FormData,Array.from(fileProps).forEach((function(_ref6){var file=_ref6.file;formdata.append("file",file)})),_context.next=5,breathecode.Z.todo({academy:cohortSession.academy.id}).uploadFile(currentTask.id,formdata);case 5:(null==(resp=_context.sent)?void 0:resp.status)<400?(respData=resp.data[0],setIsUploading(!1),setFileProps([]),sendProject({task:currentTask,githubUrl:null==respData?void 0:respData.url,taskStatus:"DONE"}),toast({position:"top",title:t("alert-message:files-uploaded"),status:"success",duration:4e3,isClosable:!0}),closeSettings()):(setIsUploading(!1),toast({position:"top",title:t("alert-message:something-went-wrong-with",{property:"Files"}),status:"error",duration:4e3,isClosable:!0}));case 7:case"end":return _context.stop()}}),_callee)})));return function handleUploadFile(){return _ref5.apply(this,arguments)}}(),handleCloseFile=function handleCloseFile(){closeSettings()};return PopoverTaskHandler_jsx(chunk_4OGHDZEB.J,{id:"task-status",isOpen:settingsOpen,onClose:handleCloseFile,trigger:"click"},PopoverTaskHandler_jsx(chunk_3O5UWOX6.x,null,PopoverTaskHandler_jsx(chunk_NAA7TEES.z,{display:"flex",isLoading,variant:allowText?"default":"none",isDisabled:isButtonDisabled,minWidth:"26px",minHeight:"26px",height:"fit-content",background:allowText?"blue.default":"none",lineHeight:allowText?"15px":"0",padding:allowText?"12px 24px":"0",borderRadius:allowText?"3px":"30px",textTransform:allowText?"uppercase":"none",gridGap:allowText?"12px":"0",onClick:function onClick(){return toggleSettings()}},buttonChildren&&buttonChildren,!buttonChildren&&PopoverTaskHandler_jsx(react.Fragment,null,allowText?PopoverTaskHandler_jsx(TextByTaskStatus,{currentTask,t}):PopoverTaskHandler_jsx(IconByTaskStatus,{currentTask})))),PopoverTaskHandler_jsx(chunk_KVBLLJMP.y,null,PopoverTaskHandler_jsx(chunk_6YK4VVQO.Q,null),PopoverTaskHandler_jsx(chunk_BYOOQOH2.Y,null,t("deliverProject.title")),PopoverTaskHandler_jsx(chunk_THJVJMZP.u,null),PopoverTaskHandler_jsx(chunk_3JH7ZFSI.b,null,noDeliveryFormat?PopoverTaskHandler_jsx(chunk_6CSUKJP7.xu,{display:"flex",flexDirection:"column",gridGap:"10px"},PopoverTaskHandler_jsx(chunk_P74GIWPW.x,{size:"md"},t("deliverProject.no-delivery-needed")),PopoverTaskHandler_jsx(chunk_NAA7TEES.z,{width:"fit-content",onClick:function onClick(){sendProject({task:currentTask,taskStatus:"DONE"})},colorScheme:"blue",isLoading:isSubmitting,type:"submit"},t("deliverProject.handler-text"))):PopoverTaskHandler_jsx(react.Fragment,null,"object"==typeof currentAssetData&&deliveryFormatIsUrl?PopoverTaskHandler_jsx(formik_esm.J9,{initialValues:{githubUrl:(null==currentTask?void 0:currentTask.github_url)||""},onSubmit:function onSubmit(){setIsSubmitting(!0),""!==githubUrl&&(sendProject({task:currentTask,githubUrl,taskStatus:"DONE"}),setIsSubmitting(!1),onClickHandler())},validationSchema:regexUrlExists?customUrlValidation:githubUrlValidation},(function(){var _currentAssetData$del,_currentAssetData$del2;return PopoverTaskHandler_jsx(formik_esm.l0,{style:{display:"flex",flexDirection:"column",gridGap:null!=currentAssetData&&null!==(_currentAssetData$del=currentAssetData.delivery_instructions)&&void 0!==_currentAssetData$del&&_currentAssetData$del.length?"0px":"14px"}},PopoverTaskHandler_jsx(formik_esm.gN,{name:"githubUrl"},(function(_ref7){var field=_ref7.field,form=_ref7.form;return setGithubUrl(form.values.githubUrl),PopoverTaskHandler_jsx(chunk_6ZNYZUDD.NI,{isInvalid:form.errors.githubUrl&&form.touched.githubUrl},PopoverTaskHandler_jsx(chunk_GYFRIY2Z.I,(0,esm_extends.Z)({},field,{type:"text",id:"githubUrl",color:lightColor,_focus:{color:commonInputActiveColor},placeholder:"https://..."})),PopoverTaskHandler_jsx(chunk_3GP7MWMA.J1,{marginTop:"10px"},form.errors.githubUrl))})),PopoverTaskHandler_jsx(chunk_6CSUKJP7.xu,null,(null==currentAssetData||null===(_currentAssetData$del2=currentAssetData.delivery_instructions)||void 0===_currentAssetData$del2?void 0:_currentAssetData$del2.length)>2?PopoverTaskHandler_jsx(chunk_6CSUKJP7.xu,{height:"100%",margin:"0 rem auto 0 auto",transition:"background 0.2s ease-in-out",borderRadius:"3px",maxWidth:"1280px",background:(0,chunk_7NLW6UB6.ff)("white","dark"),width:{base:"100%",md:"auto"},className:"markdown-body ".concat((0,chunk_7NLW6UB6.ff)("light","dark"))},PopoverTaskHandler_jsx(MarkDownParser.Z,{content:null==currentAssetData?void 0:currentAssetData.delivery_instructions})):PopoverTaskHandler_jsx(chunk_6CSUKJP7.xu,{dangerouslySetInnerHTML:{__html:t("deliverProject.how-to-deliver-text",{link:"https://4geeksacademy.notion.site/How-to-deliver-a-project-e1db0a8b1e2e4fbda361fc2f5457c0de"})}})),PopoverTaskHandler_jsx(chunk_NAA7TEES.z,{width:"fit-content",colorScheme:"blue",isLoading:isSubmitting,type:"submit"},t("deliverProject.handler-text")))})):PopoverTaskHandler_jsx(chunk_6CSUKJP7.xu,null,(null==currentAssetData||null===(_currentAssetData$del3=currentAssetData.delivery_instructions)||void 0===_currentAssetData$del3?void 0:_currentAssetData$del3.length)>2?PopoverTaskHandler_jsx(chunk_6CSUKJP7.xu,{height:"100%",margin:"0 rem auto 0 auto",transition:"background 0.2s ease-in-out",borderRadius:"3px",maxWidth:"1280px",background:(0,chunk_7NLW6UB6.ff)("white","dark"),width:{base:"100%",md:"auto"},className:"markdown-body ".concat((0,chunk_7NLW6UB6.ff)("light","dark"))},PopoverTaskHandler_jsx(MarkDownParser.Z,{content:null==currentAssetData?void 0:currentAssetData.delivery_instructions})):PopoverTaskHandler_jsx(chunk_P74GIWPW.x,{size:"md"},t("deliverProject.file-upload"),PopoverTaskHandler_jsx("strong",null,null==currentAssetData||null===(_currentAssetData$del4=currentAssetData.delivery_formats)||void 0===_currentAssetData$del4?void 0:_currentAssetData$del4.replaceAll(",",", ").replaceAll(".","").toUpperCase())),PopoverTaskHandler_jsx(chunk_6CSUKJP7.xu,{className:"upload-wrapper ".concat(dragOver&&"dragOver"),m:"10px 0",width:{base:"auto",md:"100%"},height:"86px",position:"relative",color:dragOver?"blue.600":"blue.default",_hover:{color:"blue.default"},transition:"0.3s all ease-in-out",borderRadius:"12px",background:featuredColor},PopoverTaskHandler_jsx(chunk_6CSUKJP7.xu,{width:"100%",height:"100%",position:"absolute",display:"flex",justifyContent:"center",alignItems:"center",border:"1px solid currentColor",cursor:"pointer",borderWidth:"2px",borderRadius:"7px"},PopoverTaskHandler_jsx(chunk_6CSUKJP7.xu,{className:"icon-bounce"},PopoverTaskHandler_jsx(Icon.Z,{icon:"upload",color:"currentColor",width:"24",height:"24"}))),PopoverTaskHandler_jsx(chunk_GYFRIY2Z.I,{type:"file",name:"Upload file",title:"",ref:fileInputRef,onChange:function handleChangeFile(e){setDragOver(!1);var fileProp=e.target.files,formatFileArr=mimeTypes.replaceAll(".","").split(",");fileProp.length>0&&Array.from(fileProp).forEach((function(file){var _fileContainerRef$cur,_fileContainerRef$cur2,type=file.type,name=file.name,size=file.size,formatError=!formatFileArr.some((function(l){return String(type).includes(l)})),sizeError=size>10485760;fileProps.some((function(item){return item.name===name}))||(setFileProps((function(prev){return[].concat((0,toConsumableArray.Z)(prev),[{name,type,size,file,formatError,sizeError}])})),null===(_fileContainerRef$cur=fileContainerRef.current)||void 0===_fileContainerRef$cur||_fileContainerRef$cur.scrollTo({top:null===(_fileContainerRef$cur2=fileContainerRef.current)||void 0===_fileContainerRef$cur2?void 0:_fileContainerRef$cur2.scrollHeight,behavior:"smooth"}),setTimeout((function(){var _fileContainerRef$cur3,_fileContainerRef$cur4;null===(_fileContainerRef$cur3=fileContainerRef.current)||void 0===_fileContainerRef$cur3||_fileContainerRef$cur3.scrollTo({top:null===(_fileContainerRef$cur4=fileContainerRef.current)||void 0===_fileContainerRef$cur4?void 0:_fileContainerRef$cur4.scrollHeight,behavior:"smooth"})}),[300]))}))},accept:null==currentAssetData?void 0:currentAssetData.delivery_formats,placeholder:"Upload profile image",multiple:"multiple",position:"absolute",width:"100%",height:"100%",cursor:"pointer",opacity:"0",padding:"0",onDragOver:function onDragOver(){return setDragOver(!0)},onDragLeave:function onDragLeave(){return setDragOver(!1)}})),fileProps.some((function(file){return"string"==typeof(null==file?void 0:file.type)}))&&PopoverTaskHandler_jsx(react.Fragment,null,PopoverTaskHandler_jsx(chunk_6CSUKJP7.xu,{ref:fileContainerRef,maxHeight:"300px",overflowY:"auto"},fileProps.map((function(file){var errorExists=file.formatError||file.sizeError,extension=file.name.split(".").pop(),isImage=["jpg","jpeg","png","gif","svg"].includes(extension),icon=iconDict.includes(extension)?extension:"file";return PopoverTaskHandler_jsx(chunk_6CSUKJP7.xu,{key:file.name,display:"flex",my:"15px",p:"8px",border:"1px solid",borderColor:featuredColor,background:modal.background,justifyContent:"space-between",alignItems:"center",borderRadius:"7px"},PopoverTaskHandler_jsx(chunk_6CSUKJP7.xu,{display:"flex",gridGap:"9px"},PopoverTaskHandler_jsx(Icon.Z,{icon:isImage?"image":icon,color:hexColor.black,width:"32px",height:"41px"}),PopoverTaskHandler_jsx(chunk_6CSUKJP7.xu,{position:"relative"},PopoverTaskHandler_jsx(chunk_P74GIWPW.x,{size:"14px",style:{margin:"0px"},withLimit:file.name.length>20},file.name),PopoverTaskHandler_jsx(chunk_P74GIWPW.x,{size:"14px",style:{margin:"0px"},color:errorExists&&hexColor.danger,display:"flex",gridGap:"6px"},errorExists?PopoverTaskHandler_jsx(react.Fragment,null,PopoverTaskHandler_jsx(Icon.Z,{icon:"warning",width:"13px",height:"13px",style:{marginTop:"5px"},color:"currentColor",full:!0,secondColor:hexColor.white2}),file.formatError?t("deliverProject.error-file-format"):file.sizeError&&t("deliverProject.error-file-size")):(0,utils.td)(file.size)))),PopoverTaskHandler_jsx(chunk_6CSUKJP7.xu,{borderRadius:"20px",p:"7px",backgroundColor:"gray.500",onClick:function onClick(){!function handleRemoveFileInList(name){var updatedFileList=fileProps.filter((function(file){return file.name!==name}));setFileProps(updatedFileList),fileInputRef.current.removeAttribute("multiple"),fileInputRef.current.value=null,fileInputRef.current.setAttribute("multiple","multiple")}(file.name)},cursor:"pointer"},PopoverTaskHandler_jsx(Icon.Z,{icon:"close",width:"10px",height:"10px",color:"#ffffff"})))}))),PopoverTaskHandler_jsx(chunk_6CSUKJP7.xu,{py:"12px",color:lightColor},t("deliverProject.total-size",{size:(0,utils.td)(fileSumSize)}))),PopoverTaskHandler_jsx(chunk_6CSUKJP7.xu,{display:"flex",justifyContent:"space-evenly",mb:"6px"},PopoverTaskHandler_jsx(chunk_NAA7TEES.z,{variant:"default",onClick:function onClick(){return handleUploadFile()},isLoading:isUploading,isDisabled:isUploading||0===(null==fileProps?void 0:fileProps.length)||fileProps.some((function(file){return"string"!=typeof(null==file?void 0:file.type)}))||fileErrorExists||fileSumSize>10485760,textTransform:"uppercase"},t("common:upload")),PopoverTaskHandler_jsx(chunk_NAA7TEES.z,{variant:"link",textTransform:"uppercase",onClick:function onClick(){return handleCloseFile()}},t("common:cancel"))))))))}IconByTaskStatus.displayName="IconByTaskStatus",PopoverTaskHandler.displayName="PopoverTaskHandler",PopoverTaskHandler.propTypes={isLoading:prop_types_default().bool,currentAssetData:prop_types_default().objectOf(prop_types_default().oneOfType([prop_types_default().any])),currentTask:prop_types_default().objectOf(prop_types_default().oneOfType([prop_types_default().any])),sendProject:prop_types_default().func,onClickHandler:prop_types_default().func,closeSettings:prop_types_default().func,settingsOpen:prop_types_default().bool,allowText:prop_types_default().bool,toggleSettings:prop_types_default().func,buttonChildren:prop_types_default().node},PopoverTaskHandler.defaultProps={isLoading:!1,currentAssetData:{},currentTask:{},sendProject:function sendProject(){},onClickHandler:function onClickHandler(){},closeSettings:function closeSettings(){},settingsOpen:!1,allowText:!1,toggleSettings:function toggleSettings(){},buttonChildren:null},TextByTaskStatus.propTypes={currentTask:prop_types_default().objectOf(prop_types_default().oneOfType([prop_types_default().any])),t:prop_types_default().func.isRequired},TextByTaskStatus.defaultProps={currentTask:{}},IconByTaskStatus.propTypes={currentTask:prop_types_default().objectOf(prop_types_default().oneOfType([prop_types_default().any])),noDeliveryFormat:prop_types_default().bool},IconByTaskStatus.defaultProps={currentTask:{},noDeliveryFormat:!1},PopoverTaskHandler.__docgenInfo={description:"",methods:[],displayName:"PopoverTaskHandler",props:{isLoading:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},currentAssetData:{defaultValue:{value:"{}",computed:!1},description:"",type:{name:"objectOf",value:{name:"union",value:[{name:"any"}]}},required:!1},currentTask:{defaultValue:{value:"{}",computed:!1},description:"",type:{name:"objectOf",value:{name:"union",value:[{name:"any"}]}},required:!1},sendProject:{defaultValue:{value:"() => {}",computed:!1},description:"",type:{name:"func"},required:!1},onClickHandler:{defaultValue:{value:"() => {}",computed:!1},description:"",type:{name:"func"},required:!1},closeSettings:{defaultValue:{value:"() => {}",computed:!1},description:"",type:{name:"func"},required:!1},settingsOpen:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},allowText:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},toggleSettings:{defaultValue:{value:"() => {}",computed:!1},description:"",type:{name:"func"},required:!1},buttonChildren:{defaultValue:{value:"null",computed:!1},description:"",type:{name:"node"},required:!1}}};const components_PopoverTaskHandler=PopoverTaskHandler;TextByTaskStatus.__docgenInfo={description:"",methods:[],displayName:"TextByTaskStatus",props:{currentTask:{defaultValue:{value:"{}",computed:!1},description:"",type:{name:"objectOf",value:{name:"union",value:[{name:"any"}]}},required:!1},t:{description:"",type:{name:"func"},required:!0}}},IconByTaskStatus.__docgenInfo={description:"",methods:[],displayName:"IconByTaskStatus",props:{currentTask:{defaultValue:{value:"{}",computed:!1},description:"",type:{name:"objectOf",value:{name:"union",value:[{name:"any"}]}},required:!1},noDeliveryFormat:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1}}};var requests=__webpack_require__("./src/utils/requests.js"),useModuleHandler_console=__webpack_require__("./node_modules/console-browserify/index.js");function useModuleHandler_ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function useModuleHandler_objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?useModuleHandler_ownKeys(Object(t),!0).forEach((function(r){(0,defineProperty.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):useModuleHandler_ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var updateAssignment=function(){var _ref2=(0,asyncToGenerator.Z)(regenerator_default().mark((function _callee(_ref){var t,task,closeSettings,toast,githubUrl,contextState,setContextState,taskStatus,toggleStatus,taskToUpdate,keyIndex,projectUrl,isDelivering,_taskToUpdate,_keyIndex;return regenerator_default().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(t=_ref.t,task=_ref.task,closeSettings=_ref.closeSettings,toast=_ref.toast,githubUrl=_ref.githubUrl,contextState=_ref.contextState,setContextState=_ref.setContextState,taskStatus=_ref.taskStatus,toggleStatus=void 0===task.task_status||"PENDING"===task.task_status?"DONE":"PENDING",!task.task_type||"PROJECT"===task.task_type){_context.next=20;break}return taskToUpdate=useModuleHandler_objectSpread(useModuleHandler_objectSpread({},task),{},{id:task.id,task_status:toggleStatus}),_context.prev=4,_context.next=7,breathecode.Z.todo({}).update(taskToUpdate);case 7:keyIndex=contextState.taskTodo.findIndex((function(x){return x.id===task.id})),setContextState(useModuleHandler_objectSpread(useModuleHandler_objectSpread({},contextState),{},{taskTodo:[].concat((0,toConsumableArray.Z)(contextState.taskTodo.slice(0,keyIndex)),[taskToUpdate],(0,toConsumableArray.Z)(contextState.taskTodo.slice(keyIndex+1)))})),toast({position:"top",title:t("alert-message:assignment-updated"),status:"success",duration:6e3,isClosable:!0}),closeSettings(),_context.next=18;break;case 13:_context.prev=13,_context.t0=_context.catch(4),useModuleHandler_console.log(_context.t0),toast({position:"top",title:t("alert-message:assignment-update-error"),status:"errror",duration:5e3,isClosable:!0}),closeSettings();case 18:_context.next=36;break;case 20:return projectUrl=function getProjectUrl(){return githubUrl||""}(),isDelivering=""!==projectUrl,_taskToUpdate=useModuleHandler_objectSpread(useModuleHandler_objectSpread({},task),{},{task_status:taskStatus||toggleStatus,github_url:projectUrl,revision_status:"PENDING",delivered_at:new Date}),_context.prev=24,_context.next=27,breathecode.Z.todo({}).update(_taskToUpdate);case 27:_context.sent.data.github_url===projectUrl&&(_keyIndex=contextState.taskTodo.findIndex((function(x){return x.id===task.id})),setContextState(useModuleHandler_objectSpread(useModuleHandler_objectSpread({},contextState),{},{taskTodo:[].concat((0,toConsumableArray.Z)(contextState.taskTodo.slice(0,_keyIndex)),[_taskToUpdate],(0,toConsumableArray.Z)(contextState.taskTodo.slice(_keyIndex+1)))})),(0,requests._1)({dataLayer:{event:"assignment_status_updated",task_status:taskStatus,task_id:task.id,task_title:task.title,task_associated_slug:task.associated_slug,task_type:task.task_type,task_revision_status:task.revision_status}}),toast({position:"top",title:t(isDelivering?"alert-message:delivery-success":"alert-message:delivery-removed"),status:"success",duration:6e3,isClosable:!0}),closeSettings()),_context.next=36;break;case 31:_context.prev=31,_context.t1=_context.catch(24),useModuleHandler_console.log(_context.t1),toast({position:"top",title:t("alert-message:delivery-error"),status:"errror",duration:5e3,isClosable:!0}),closeSettings();case 36:case"end":return _context.stop()}}),_callee,null,[[4,13],[24,31]])})));return function updateAssignment(_x){return _ref2.apply(this,arguments)}}(),es=__webpack_require__("./node_modules/react-redux/es/index.js");function moduleMapAction_ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function moduleMapAction_objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?moduleMapAction_ownKeys(Object(t),!0).forEach((function(r){(0,defineProperty.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):moduleMapAction_ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}const moduleMapAction=function useModuleMap(){var dispatch=(0,es.I0)(),modules=(0,es.v9)((function(state){return state.moduleMapReducer.modules})),contextState=(0,es.v9)((function(state){return state.moduleMapReducer.contextState}));return{modules,contextState,setContextState:function setContextState(newState){dispatch({type:"CHANGE_CONTEXT_STATE",payload:newState})},updateModuleStatus:function updateModuleStatus(module){var changedModules=modules.map((function(m,index){return index===module.index?moduleMapAction_objectSpread(moduleMapAction_objectSpread({},m),{},{status:module.status}):m}));dispatch({type:"CHANGE_STATUS",payload:changedModules})}}};var useAuth=__webpack_require__("./src/common/hooks/useAuth.js"),ReviewModal_console=__webpack_require__("./node_modules/console-browserify/index.js"),ReviewModal_excluded=["isExternal","externalFiles","isOpen","isStudent","externalData","defaultStage","fixedStage","onClose","updpateAssignment","currentTask","projectLink","changeStatusAssignment","disableRate"],ReviewModal_jsx=react.createElement;function _toPropertyKey(arg){var key=function _toPrimitive(input,hint){if("object"!=typeof input||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!=typeof res)return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string");return"symbol"==typeof key?key:String(key)}function ReviewModal_ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function ReviewModal_objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ReviewModal_ownKeys(Object(t),!0).forEach((function(r){(0,defineProperty.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ReviewModal_ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var stages={initial:"initial",file_list:"file_list",code_review:"code_review",approve_or_reject_code_revision:"approve_or_reject_code_revision",review_code_revision:"review_code_revision"},APPROVED="APPROVED",PENDING="PENDING",REJECTED="REJECTED";function ReviewModal(_ref){var _currentTask$user,_currentTask$user2,_contextData$commitFi,_contextData$code_rev,_contextData$code_rev2,_contextData$code_rev3,_contextData$commitFi2,_contextData$revision,isExternal=_ref.isExternal,externalFiles=_ref.externalFiles,isOpen=_ref.isOpen,isStudent=_ref.isStudent,externalData=_ref.externalData,defaultStage=_ref.defaultStage,fixedStage=_ref.fixedStage,_onClose=_ref.onClose,updpateAssignment=_ref.updpateAssignment,currentTask=_ref.currentTask,changeStatusAssignment=(_ref.projectLink,_ref.changeStatusAssignment),disableRate=_ref.disableRate,rest=(0,objectWithoutProperties.Z)(_ref,ReviewModal_excluded),t=(0,useTranslation.Z)("assignments").t,isAuthenticatedWithRigobot=(0,useAuth.Z)().isAuthenticatedWithRigobot,toast=(0,chunk_ENIANY67.p)(),_useState=(0,react.useState)(""),selectedText=_useState[0],setSelectedText=_useState[1],_useState2=(0,react.useState)({isFetchingCommitFiles:!1,isFetchingCodeReviews:!1,isApprovingOrRejecting:!1}),loaders=_useState2[0],setLoaders=_useState2[1],_usePersistent=(0,usePersistent.K)("profile",{}),profile=(0,slicedToArray.Z)(_usePersistent,1)[0],_useState3=(0,react.useState)(""),comment=_useState3[0],setComment=_useState3[1],_usePersistent3=(0,usePersistent.K)("cohortSession",{}),cohortSession=(0,slicedToArray.Z)(_usePersistent3,1)[0],_useState4=(0,react.useState)(null),currentAssetData=_useState4[0],setCurrentAssetData=_useState4[1],_useState5=(0,react.useState)(!1),settingsOpen=_useState5[0],setSettingsOpen=_useState5[1],_useState6=(0,react.useState)(!1),openUndoApproval=_useState6[0],setOpenUndoApproval=_useState6[1],_useState7=(0,react.useState)(),fileData=_useState7[0],setFileData=_useState7[1],_useModuleMap=moduleMapAction(),contextState=_useModuleMap.contextState,setContextState=_useModuleMap.setContextState,_useState8=(0,react.useState)(""),reviewStatus=_useState8[0],setReviewStatus=_useState8[1],_useState9=(0,react.useState)({commitFiles:{task:{},fileList:[]},commitFile:{},code_revisions:[],my_revisions:[],revision_content:{}}),contextData=_useState9[0],setContextData=_useState9[1],_useState10=(0,react.useState)({current:defaultStage,previous:{}}),stageHistory=_useState10[0],setStageHistory=_useState10[1],_useStyle=(0,useStyle.Z)(),lightColor=_useStyle.lightColor,featuredColor=_useStyle.featuredColor,hexColor=_useStyle.hexColor,storybookTranslation=(null==contextData?void 0:contextData.translation)||{},fullName="".concat(null==currentTask||null===(_currentTask$user=currentTask.user)||void 0===_currentTask$user?void 0:_currentTask$user.first_name," ").concat(null==currentTask||null===(_currentTask$user2=currentTask.user)||void 0===_currentTask$user2?void 0:_currentTask$user2.last_name),taskStatus=null==currentTask?void 0:currentTask.task_status,revisionStatus=null==currentTask?void 0:currentTask.revision_status,hasNotBeenReviewed=revisionStatus===PENDING,hasBeenApproved=revisionStatus===APPROVED,hasBeenRejected=revisionStatus===REJECTED,noFilesToReview=!hasBeenApproved&&0===(null==contextData||null===(_contextData$commitFi=contextData.commitFiles)||void 0===_contextData$commitFi||null===(_contextData$commitFi=_contextData$commitFi.fileList)||void 0===_contextData$commitFi?void 0:_contextData$commitFi.length),hasFilesToReview=(null==contextData||null===(_contextData$code_rev=contextData.code_revisions)||void 0===_contextData$code_rev?void 0:_contextData$code_rev.length)>0||!isStudent,stage=null==stageHistory?void 0:stageHistory.current,isReadyToApprove=(null==contextData||null===(_contextData$code_rev2=contextData.code_revisions)||void 0===_contextData$code_rev2?void 0:_contextData$code_rev2.length)>=0&&"DONE"===taskStatus,isStageWithDefaultStyles=hasBeenApproved||stage===stages.initial||stage===stages.approve_or_reject_code_revision||noFilesToReview,showGoBackButton=stage!==stages.initial&&!fixedStage,statusColor={approve:"success",reject:"error"},buttonColor={approve:"success",reject:"danger"},buttonText={approve:t("review-assignment.approve"),reject:t("review-assignment.reject")},assignmentButtonColor_remove="danger",revisionStatusUpperCase={approve:APPROVED,reject:REJECTED},reviewHint={approve:t("code-review.why-approve"),reject:t("code-review.why-reject")},alertStatus={approve:t("alert-message:review-assignment-approve"),reject:t("alert-message:review-assignment-reject")},setStage=function setStage(newStage){var type=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"next";setStageHistory((function(prevState){if("next"===type){var newPrevious=ReviewModal_objectSpread(ReviewModal_objectSpread({},null==prevState?void 0:prevState.previous),{},(0,defineProperty.Z)({},null==prevState?void 0:prevState.current,!0));return{current:newStage,previous:newPrevious}}if("back"===type){var keys=Object.keys(prevState.previous),lastKey=keys[keys.length-1],newCurrent=lastKey||defaultStage,_prevState$previous=prevState.previous;_prevState$previous[lastKey];return{current:newCurrent,previous:(0,objectWithoutProperties.Z)(_prevState$previous,[lastKey].map(_toPropertyKey))}}return prevState}))},getRepoFiles=function(){var _ref2=(0,asyncToGenerator.Z)(regenerator_default().mark((function _callee(){var response,data;return regenerator_default().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(_context.prev=0,!isStudent){_context.next=7;break}return _context.next=4,breathecode.Z.assignments().personalFiles(currentTask.id);case 4:_context.t0=_context.sent,_context.next=10;break;case 7:return _context.next=9,breathecode.Z.assignments().files(currentTask.id);case 9:_context.t0=_context.sent;case 10:return response=_context.t0,_context.next=13,response.json();case 13:data=_context.sent,response.ok?setContextData((function(prevState){return ReviewModal_objectSpread(ReviewModal_objectSpread({},prevState),{},{commitFiles:{task:currentTask,fileList:data}})})):setContextData((function(prevState){return ReviewModal_objectSpread(ReviewModal_objectSpread({},prevState),{},{commitFiles:{task:currentTask,fileList:[]}})})),_context.next=20;break;case 17:_context.prev=17,_context.t1=_context.catch(0),_context.t1("Error fetching repo files:",_context.t1);case 20:case"end":return _context.stop()}}),_callee,null,[[0,17]])})));return function getRepoFiles(){return _ref2.apply(this,arguments)}}(),getCodeRevisions=function(){var _ref3=(0,asyncToGenerator.Z)(regenerator_default().mark((function _callee2(){var response,data,codeRevisionsSortedByDate;return regenerator_default().wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(_context2.prev=0,!isStudent){_context2.next=7;break}return _context2.next=4,breathecode.Z.assignments().getPersonalCodeRevisionsByTask(currentTask.id);case 4:_context2.t0=_context2.sent,_context2.next=10;break;case 7:return _context2.next=9,breathecode.Z.assignments().getCodeRevisions(currentTask.id);case 9:_context2.t0=_context2.sent;case 10:return response=_context2.t0,_context2.next=13,response.json();case 13:data=_context2.sent,response.ok?(codeRevisionsSortedByDate=data.sort((function(a,b){return new Date(b.created_at)-new Date(a.created_at)})),setContextData((function(prev){return ReviewModal_objectSpread(ReviewModal_objectSpread({},prev),{},{code_revisions:codeRevisionsSortedByDate,my_revisions:data.filter((function(revision){var _revision$reviewer;return(null==revision||null===(_revision$reviewer=revision.reviewer)||void 0===_revision$reviewer?void 0:_revision$reviewer.username)===(null==profile?void 0:profile.email)}))})}))):toast({title:t("alert-message:something-went-wrong"),description:"Cannot get code revisions",status:"error",duration:5e3,position:"top",isClosable:!0}),_context2.next=20;break;case 17:_context2.prev=17,_context2.t1=_context2.catch(0),ReviewModal_console.error("Error fetching code revisions:",_context2.t1);case 20:return _context2.prev=20,setLoaders((function(prevState){return ReviewModal_objectSpread(ReviewModal_objectSpread({},prevState),{},{isFetchingCodeReviews:!1})})),_context2.finish(20);case 23:case"end":return _context2.stop()}}),_callee2,null,[[0,17,20,23]])})));return function getCodeRevisions(){return _ref3.apply(this,arguments)}}();(0,react.useEffect)((function(){externalData&&setContextData((function(){return ReviewModal_objectSpread({},externalData)}))}),[isOpen,externalData]),(0,react.useEffect)((function(){defaultStage&&setStage(defaultStage),isOpen&&(null==currentTask?void 0:currentTask.id)>0&&!externalData&&(externalFiles&&setFileData(externalFiles),setLoaders((function(prevState){return ReviewModal_objectSpread(ReviewModal_objectSpread({},prevState),{},{isFetchingCodeReviews:!0})})),getRepoFiles(),getCodeRevisions())}),[isOpen,null==currentTask?void 0:currentTask.id,externalData]);var widthSizes={initial:isAuthenticatedWithRigobot&&noFilesToReview||!hasFilesToReview?"28rem":"36rem",approve_or_reject_code_revision:"36rem",file_list:"42rem",code_review:"74rem",review_code_revision:"56rem"},handleCommitFilesStage=function handleCommitFilesStage(){setStage(isStudent?stages.review_code_revision:stages.file_list)},proceedToCommitFiles=function(){var _ref4=(0,asyncToGenerator.Z)(regenerator_default().mark((function _callee3(){return regenerator_default().wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:setLoaders((function(prevState){return ReviewModal_objectSpread(ReviewModal_objectSpread({},prevState),{},{isFetchingCommitFiles:!0})})),handleCommitFilesStage(),setLoaders((function(prevState){return ReviewModal_objectSpread(ReviewModal_objectSpread({},prevState),{},{isFetchingCommitFiles:!1})}));case 3:case"end":return _context3.stop()}}),_callee3)})));return function proceedToCommitFiles(){return _ref4.apply(this,arguments)}}(),getAssetData=function(){var _ref5=(0,asyncToGenerator.Z)(regenerator_default().mark((function _callee4(){var _ref6$callback,callback,assetResp,assetData,_cohortSession$academ,fileResp,respData,_args4=arguments;return regenerator_default().wrap((function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return _ref6$callback=(_args4.length>0&&void 0!==_args4[0]?_args4[0]:{}).callback,callback=void 0===_ref6$callback?function(){}:_ref6$callback,_context4.next=3,breathecode.Z.lesson().getAsset(currentTask.associated_slug);case 3:if(!((assetResp=_context4.sent).status<400)){_context4.next=19;break}return setLoaders((function(prevState){return ReviewModal_objectSpread(ReviewModal_objectSpread({},prevState),{},{isOpeningResubmitForm:!1})})),_context4.next=8,assetResp.data;case 8:if(assetData=_context4.sent,setCurrentAssetData(assetData),"string"!=typeof(null==assetData?void 0:assetData.delivery_formats)||null!=assetData&&assetData.delivery_formats.includes("url")){_context4.next=18;break}return _context4.next=13,breathecode.Z.todo().getFile({id:currentTask.id,academyId:null==cohortSession||null===(_cohortSession$academ=cohortSession.academy)||void 0===_cohortSession$academ?void 0:_cohortSession$academ.id});case 13:return fileResp=_context4.sent,_context4.next=16,fileResp.data;case 16:respData=_context4.sent,setFileData(respData);case 18:callback();case 19:case"end":return _context4.stop()}}),_callee4)})));return function getAssetData(){return _ref5.apply(this,arguments)}}(),toggleSettings=function(){var _ref7=(0,asyncToGenerator.Z)(regenerator_default().mark((function _callee5(){return regenerator_default().wrap((function _callee5$(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:setLoaders((function(prevState){return ReviewModal_objectSpread(ReviewModal_objectSpread({},prevState),{},{isOpeningResubmitForm:!0})})),getAssetData({callback:function callback(){return setSettingsOpen(!settingsOpen)}});case 2:case"end":return _context5.stop()}}),_callee5)})));return function toggleSettings(){return _ref7.apply(this,arguments)}}(),closeSettings=function closeSettings(){setSettingsOpen(!1)},sendProject=function(){var _ref9=(0,asyncToGenerator.Z)(regenerator_default().mark((function _callee6(_ref8){var task,githubUrl,newTaskStatus;return regenerator_default().wrap((function _callee6$(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:return task=_ref8.task,githubUrl=_ref8.githubUrl,newTaskStatus=_ref8.taskStatus,_context6.next=3,updateAssignment({t,task,closeSettings,toast,githubUrl,taskStatus:newTaskStatus,contextState,setContextState});case 3:case"end":return _context6.stop()}}),_callee6)})));return function sendProject(_x){return _ref9.apply(this,arguments)}}();return ReviewModal_jsx(components_SimpleModal,(0,esm_extends.Z)({isOpen,onClose:function onClose(){_onClose(),setContextData({}),setStage(stages.initial)},title:function getTitle(){var _storybookTranslation3,_storybookTranslation,_storybookTranslation2;return stage===stages.initial?(null==storybookTranslation||null===(_storybookTranslation=storybookTranslation["code-review"])||void 0===_storybookTranslation?void 0:_storybookTranslation["assignment-review"])||t("code-review.assignment-review"):stage===stages.approve_or_reject_code_revision?(null==storybookTranslation||null===(_storybookTranslation2=storybookTranslation["code-review"])||void 0===_storybookTranslation2?void 0:_storybookTranslation2["write-feedback"])||t("code-review.write-feedback"):(null==storybookTranslation||null===(_storybookTranslation3=storybookTranslation["code-review"])||void 0===_storybookTranslation3?void 0:_storybookTranslation3["code-review"])||t("code-review.rigobot-code-review")}(),closeOnOverlayClick:!1,maxWidth:noFilesToReview?widthSizes.initial:widthSizes[stage],minWidth:stage===stages.code_review&&"83vw",minHeight:isStageWithDefaultStyles?"auto":"30rem",overflow:stages.initial?"initial":"auto",margin:"0 10px",bodyStyles:{display:"flex",gridGap:"20px",padding:"1rem 1.5rem"},headerStyles:{userSelect:"none",textTransform:isStageWithDefaultStyles?"uppercase":"initial",fontSize:isStageWithDefaultStyles?"15px":"26px",textAlign:"center",fontWeight:700},closeButtonStyles:{top:isStageWithDefaultStyles?2:5},leftButton:showGoBackButton&&ReviewModal_jsx(chunk_NAA7TEES.z,{position:"absolute",variant:"unstyled",top:isStageWithDefaultStyles?2:4,left:5,onClick:function onClick(){setStage("","back")},"aria-label":t("common:go-back")},ReviewModal_jsx(Icon.Z,{icon:"arrowLeft2",width:"26px",height:"15px",color:hexColor.black}))},rest),stage===stages.initial&&currentTask&&ReviewModal_jsx(chunk_6CSUKJP7.xu,{width:"100%",maxWidth:"500px",margin:"0 auto",mb:"8px",position:"relative"},loaders.isFetchingCodeReviews?ReviewModal_jsx(chunk_6CSUKJP7.xu,{minHeight:"215px"},ReviewModal_jsx(LoaderScreen.Z,{width:"300px",height:"302px"})):ReviewModal_jsx(react.Fragment,null,hasFilesToReview&&!isReadyToApprove&&ReviewModal_jsx(AlertMessage.Z,{type:isStudent?"info":"warning",full:!0,message:t(isStudent?"code-review.info-student":"code-review.info-teacher"),borderRadius:"4px",padding:"8px",mb:"24px"}),ReviewModal_jsx(chunk_MPFPK3CX.k,{flexDirection:"column",gridGap:"16px"},isStudent?ReviewModal_jsx(Text.Z,{size:"15px",color:lightColor},hasNotBeenReviewed?t("dashboard:modalInfo.still-reviewing"):ReviewModal_jsx(react.Fragment,null,revisionStatus===APPROVED&&t("code-review.assignment-approved-msg"),revisionStatus===REJECTED&&t("code-review.assignment-rejected-msg"))):ReviewModal_jsx(chunk_MPFPK3CX.k,{justifyContent:"space-between"},ReviewModal_jsx(Text.Z,{size:"14px",color:lightColor},t("code-review.student-name",{name:fullName})),"DONE"===taskStatus&&hasNotBeenReviewed&&ReviewModal_jsx(chunk_6CSUKJP7.xu,{textTransform:"uppercase",fontSize:"13px",background:"yellow.light",color:"yellow.default",borderRadius:"27px",padding:"2px 6px",fontWeight:700,border:"2px solid",borderColor:"yellow.default"},t("code-review.waiting-for-review"))),(hasBeenApproved||hasBeenRejected)&&(null==currentTask?void 0:currentTask.description)&&ReviewModal_jsx(chunk_MPFPK3CX.k,{background:featuredColor,flexDirection:"column",gridGap:"4px",padding:"8px 14px",borderRadius:"3px"},ReviewModal_jsx(chunk_6CSUKJP7.xu,{fontSize:"14px",fontWeight:700},t("code-review.your-teacher-said")),ReviewModal_jsx(Text.Z,{display:"flex",alignContent:"center",color:lightColor,borderRadius:"4px",width:"100%",size:"12px"},null==currentTask?void 0:currentTask.description)),ReviewModal_jsx(chunk_MPFPK3CX.k,{flexDirection:"column",color:lightColor},ReviewModal_jsx(Text.Z,{size:"14px",fontWeight:700},t(isStudent?"dashboard:modalInfo.link-info":"code-review.project-delivered")),ReviewModal_jsx(chunk_YTV6DHKL.r,{variant:"default",fontSize:"14px",href:null==currentTask?void 0:currentTask.github_url},null==currentTask?void 0:currentTask.title)),Array.isArray(fileData)&&fileData.length>0&&ReviewModal_jsx(chunk_6CSUKJP7.xu,{mt:"10px"},ReviewModal_jsx(Text.Z,{size:"l",mb:"8px"},t("modalInfo.files-sended-to-teacher")),ReviewModal_jsx(chunk_6CSUKJP7.xu,{display:"flex",flexDirection:"column",gridGap:"8px",maxHeight:"135px",overflowY:"auto"},fileData.map((function(file){var extension=file.name.split(".").pop(),isImage=["jpg","jpeg","png","gif","svg"].includes(extension),icon=iconDict.includes(extension)?extension:"file";return ReviewModal_jsx(chunk_6CSUKJP7.xu,{key:"".concat(file.id,"-").concat(file.name),display:"flex"},ReviewModal_jsx(Icon.Z,{icon:isImage?"image":icon,width:"22px",height:"22px"}),ReviewModal_jsx(chunk_YTV6DHKL.r,{href:file.url,target:"_blank",rel:"noopener noreferrer",color:"blue.500",margin:"0 0 0 10px"},file.name))})))),(!isAuthenticatedWithRigobot||!noFilesToReview)&&hasFilesToReview&&!disableRate&&ReviewModal_jsx(chunk_MPFPK3CX.k,{padding:"8px",flexDirection:"column",gridGap:"16px",background:featuredColor,borderRadius:"4px"},ReviewModal_jsx(chunk_MPFPK3CX.k,{alignItems:"center",gridGap:"10px"},ReviewModal_jsx(Icon.Z,{icon:"code",width:"18.5px",height:"17px",color:"currentColor"}),ReviewModal_jsx(Text.Z,{size:"14px",fontWeight:700},t("code-review.count-code-reviews",{count:null==contextData||null===(_contextData$code_rev3=contextData.code_revisions)||void 0===_contextData$code_rev3?void 0:_contextData$code_rev3.length}))),ReviewModal_jsx(chunk_NAA7TEES.z,{height:"auto",width:"fit-content",onClick:proceedToCommitFiles,isLoading:loaders.isFetchingCommitFiles,variant:"link",display:"flex",alignItems:"center",gridGap:"10px",justifyContent:"start"},t(isStudent?"code-review.read-and-rate-the-feedback":"code-review.start-code-review"),ReviewModal_jsx(Icon.Z,{icon:"longArrowRight",width:"24px",height:"10px",color:hexColor.blueDefault}))),isReadyToApprove&&!isStudent&&!hasBeenApproved&&ReviewModal_jsx(chunk_MPFPK3CX.k,{justifyContent:"space-between",pt:"8px"},["reject","approve"].map((function(type){return ReviewModal_jsx(chunk_NAA7TEES.z,{minWidth:"128px",background:buttonColor[type],_hover:{background:buttonColor[type]},onClick:function onClick(){setStage(stages.approve_or_reject_code_revision),setReviewStatus(type)},color:"white",borderRadius:"3px",fontSize:"13px",textTransform:"uppercase"},buttonText[type])}))),isStudent&&revisionStatus!==APPROVED&&ReviewModal_jsx(chunk_MPFPK3CX.k,{justifyContent:"space-between",pt:"8px"},ReviewModal_jsx(chunk_NAA7TEES.z,{minWidth:"128px",isLoading:loaders.isRemovingDelivery,background:assignmentButtonColor_remove,_hover:{background:assignmentButtonColor_remove},onClick:function onClick(event){setLoaders((function(prevState){return ReviewModal_objectSpread(ReviewModal_objectSpread({},prevState),{},{isRemovingDelivery:!0})})),changeStatusAssignment(event,currentTask,PENDING).finally((function(){setLoaders((function(prevState){return ReviewModal_objectSpread(ReviewModal_objectSpread({},prevState),{},{isRemovingDelivery:!1})}))}))},color:"white",borderRadius:"3px",fontSize:"13px",textTransform:"uppercase"},"Remove delivery"),ReviewModal_jsx(components_PopoverTaskHandler,{isLoading:loaders.isOpeningResubmitForm,currentAssetData,currentTask,sendProject,settingsOpen,closeSettings,toggleSettings,allowText:!0,buttonChildren:t("code-review.resubmit-assignment")})),!isStudent&&hasBeenApproved&&ReviewModal_jsx(react.Fragment,null,ReviewModal_jsx(chunk_NAA7TEES.z,{minWidth:"128px",mt:"8px",onClick:function onClick(){return setOpenUndoApproval(!0)},color:"currentColor",borderRadius:"3px",fontSize:"13px",textTransform:"uppercase",variant:"outline",width:"fit-content",alignSelf:"center"},t("task-handler.undo-approval")),ReviewModal_jsx(components_UndoApprovalModal,{isOpen:openUndoApproval,onSuccess:function onSuccess(){_onClose(),setContextData({})},onClose:function onClose(){return setOpenUndoApproval(!1)},updpateAssignment,currentTask}))))),stage===stages.approve_or_reject_code_revision&&ReviewModal_jsx(chunk_MPFPK3CX.k,{flexDirection:"column",maxWidth:"500px",margin:"0 auto",gridGap:"15px",width:"100%"},ReviewModal_jsx(chunk_6CSUKJP7.xu,{position:"relative"},ReviewModal_jsx(Text.Z,{fontSize:"14px",fontWeight:700,mb:"18px"},reviewHint[reviewStatus]),ReviewModal_jsx(chunk_OEQDSMWZ.g,{"aria-label":"feedback input",fontSize:"12px",onChange:function onChangeComment(e){setComment(e.target.value)},minHeight:"134",placeholder:t("code-review.start-review-here")}),ReviewModal_jsx(chunk_6CSUKJP7.xu,{position:"absolute",bottom:1.5,right:3,color:comment.length<10?"#EB5757":"currentColor"},"".concat(comment.length," / ").concat(500))),ReviewModal_jsx(chunk_NAA7TEES.z,{isLoading:loaders.isApprovingOrRejecting,variant:"default",alignSelf:"flex-end",isDisabled:comment.length<10||void 0===revisionStatusUpperCase[reviewStatus],onClick:function approveOrRejectProject(){void 0!==revisionStatusUpperCase[reviewStatus]&&(setLoaders((function(prevState){return ReviewModal_objectSpread(ReviewModal_objectSpread({},prevState),{},{isApprovingOrRejecting:!0})})),breathecode.Z.todo().update({id:currentTask.id,revision_status:revisionStatusUpperCase[reviewStatus],description:comment}).then((function(){toast({position:"top",title:alertStatus[reviewStatus],status:statusColor[reviewStatus],duration:5e3,isClosable:!0}),updpateAssignment(ReviewModal_objectSpread(ReviewModal_objectSpread({},currentTask),{},{id:currentTask.id,revision_status:revisionStatusUpperCase[reviewStatus],description:comment})),setStage(stages.initial),setContextData({}),setReviewStatus(""),_onClose()})).catch((function(){toast({position:"top",title:t("alert-message:review-assignment-error"),status:"error",duration:5e3,isClosable:!0})})).finally((function(){setLoaders((function(prevState){return ReviewModal_objectSpread(ReviewModal_objectSpread({},prevState),{},{isApprovingOrRejecting:!1})}))})))}},t("code-review.send-feedback"))),stage===stages.file_list&&!loaders.isFetchingCommitFiles&&ReviewModal_jsx(ReviewModal_FileList,{isStudent,contextData,setContextData,currentTask,updpateAssignment,stage,stages,setStage,setReviewStatus}),stage===stages.code_review&&((null===(_contextData$commitFi2=contextData.commitFile)||void 0===_contextData$commitFi2?void 0:_contextData$commitFi2.code)||(null===(_contextData$revision=contextData.revision_content)||void 0===_contextData$revision?void 0:_contextData$revision.code))&&ReviewModal_jsx(ReviewModal_CodeReview,{isExternal,onClose:_onClose,disableRate,isStudent,setStage,handleResetFlow:function handleResetFlow(){setContextData((function(prevState){return ReviewModal_objectSpread(ReviewModal_objectSpread({},prevState),{},{commitFile:{}})})),setSelectedText("")},contextData,setContextData,selectedText,handleSelectedText:function handleSelectedText(){var text=window.getSelection().toString();text.length>0&&setSelectedText(text)}}),stage===stages.review_code_revision&&ReviewModal_jsx(ReviewModal_ReviewCodeRevision,{contextData,setContextData,stage,stages,setStage}))}ReviewModal.displayName="ReviewModal",ReviewModal.propTypes={isOpen:prop_types_default().bool,onClose:prop_types_default().func,currentTask:prop_types_default().objectOf(prop_types_default().oneOfType([prop_types_default().any])),projectLink:prop_types_default().string,defaultStage:prop_types_default().string,updpateAssignment:prop_types_default().func.isRequired,externalData:prop_types_default().objectOf(prop_types_default().oneOfType([prop_types_default().any])),isStudent:prop_types_default().bool,changeStatusAssignment:prop_types_default().func,fixedStage:prop_types_default().bool,disableRate:prop_types_default().bool,isExternal:prop_types_default().bool},ReviewModal.defaultProps={isOpen:!1,onClose:function onClose(){},currentTask:{},projectLink:"",defaultStage:stages.initial,externalData:null,isStudent:!1,changeStatusAssignment:function changeStatusAssignment(){},fixedStage:!1,disableRate:!1,isExternal:!1},ReviewModal.__docgenInfo={description:"",methods:[],displayName:"ReviewModal",props:{isOpen:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},onClose:{defaultValue:{value:"() => {}",computed:!1},description:"",type:{name:"func"},required:!1},currentTask:{defaultValue:{value:"{}",computed:!1},description:"",type:{name:"objectOf",value:{name:"union",value:[{name:"any"}]}},required:!1},projectLink:{defaultValue:{value:"''",computed:!1},description:"",type:{name:"string"},required:!1},defaultStage:{defaultValue:{value:"'initial'",computed:!1},description:"",type:{name:"string"},required:!1},externalData:{defaultValue:{value:"null",computed:!1},description:"",type:{name:"objectOf",value:{name:"union",value:[{name:"any"}]}},required:!1},isStudent:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},changeStatusAssignment:{defaultValue:{value:"() => {}",computed:!1},description:"",type:{name:"func"},required:!1},fixedStage:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},disableRate:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},isExternal:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},updpateAssignment:{description:"",type:{name:"func"},required:!0}}};const components_ReviewModal=ReviewModal;var Feedback_jsx=react.createElement;function Feedback_ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function Feedback_objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?Feedback_ownKeys(Object(t),!0).forEach((function(r){(0,defineProperty.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Feedback_ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var base64regex=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/;function Feedback(_ref){var _storyConfig$translat,_storyConfig$translat2,_translationChoosePro,_translationChoosePro2,_translationChoosePro3,_translationChoosePro4,_translationChoosePro5,_translationChoosePro6,storyConfig=_ref.storyConfig,_useTranslation=(0,useTranslation.Z)("choose-program"),t=_useTranslation.t,lang=_useTranslation.lang,isAuthenticated=(0,useAuth.Z)().isAuthenticated,accessToken=(0,utils.qn)("accessToken"),_useStyle=(0,useStyle.Z)(),backgroundColor=_useStyle.backgroundColor,featuredColor=_useStyle.featuredColor,borderColor2=_useStyle.borderColor2,hexColor=_useStyle.hexColor,_useState=(0,react.useState)({}),selectedData=_useState[0],setSelectedData=_useState[1],_useState2=(0,react.useState)([]),codeRevisions=_useState2[0],setCodeRevisions=_useState2[1],_useState3=(0,react.useState)(!1),isAuthenticatedWithRigobot=_useState3[0],setIsAuthenticatedWithRigobot=_useState3[1],_useState4=(0,react.useState)(!1),isOpen=_useState4[0],setIsOpen=_useState4[1],isStorybookView=null==storyConfig?void 0:storyConfig.externalCodeRevisions,translationChooseProgram=null==storyConfig||null===(_storyConfig$translat=storyConfig.translation)||void 0===_storyConfig$translat?void 0:_storyConfig$translat[null==storyConfig?void 0:storyConfig.locale]["choose-program"],storybookTranslation=null==storyConfig||null===(_storyConfig$translat2=storyConfig.translation)||void 0===_storyConfig$translat2?void 0:_storyConfig$translat2[null==storyConfig?void 0:storyConfig.locale],getCodeRevisions=function(){var _ref2=(0,asyncToGenerator.Z)(regenerator_default().mark((function _callee(){var response,data,codeRevisionsSortedByDate;return regenerator_default().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.prev=0,_context.next=3,breathecode.Z.assignments().getPersonalCodeRevisions();case 3:return response=_context.sent,_context.next=6,response.json();case 6:data=_context.sent,response.ok&&(codeRevisionsSortedByDate=data.sort((function(a,b){return new Date(b.created_at)-new Date(a.created_at)})),setCodeRevisions(codeRevisionsSortedByDate)),_context.next=13;break;case 10:_context.prev=10,_context.t0=_context.catch(0),(0,logging.vU)("Error fetching code revisions:",_context.t0);case 13:case"end":return _context.stop()}}),_callee,null,[[0,10]])})));return function getCodeRevisions(){return _ref2.apply(this,arguments)}}();return(0,react.useEffect)((function(){isStorybookView&&setCodeRevisions(null==storyConfig?void 0:storyConfig.externalCodeRevisions),isAuthenticated&&(getCodeRevisions(),breathecode.Z.auth().verifyRigobotConnection(accessToken).then((function(response){null!=response&&response.data&&setIsAuthenticatedWithRigobot(!0)})))}),[isAuthenticated,isStorybookView]),(isAuthenticated||isStorybookView)&&Feedback_jsx(chunk_6CSUKJP7.xu,{width:"100%",maxWidth:"400px",zIndex:10,borderRadius:"17px",padding:"0 2px 2px 2px",background:featuredColor},Feedback_jsx(Heading.Z,{size:"16px",textAlign:"center",p:"12px 8px",width:"100%",background:featuredColor,borderTopLeftRadius:"13px",borderTopRightRadius:"13px"},(null==translationChooseProgram||null===(_translationChoosePro=translationChooseProgram.feedback)||void 0===_translationChoosePro?void 0:_translationChoosePro.title)||t("feedback.title")),Feedback_jsx(chunk_MPFPK3CX.k,{flexDirection:"column",background:backgroundColor,padding:"0 8px",borderRadius:"0 0 17px 17px"},Feedback_jsx(chunk_MPFPK3CX.k,{flexDirection:"column",my:"6px",gridGap:"6px"},!(null!=storyConfig&&storyConfig.isAuthenticatedWithRigobot||isAuthenticatedWithRigobot)&&Feedback_jsx(AlertMessage.Z,{type:"warning",background:"yellow.light",border:"0px",color:"black",full:!0,fontSize:"12px",borderRadius:"4px",textAlign:"left",padding:"8px",gridGap:"10px",secondColor:"transparent"},Feedback_jsx(Text.Z,{size:"12px",textAlign:"start"},(null==translationChooseProgram||null===(_translationChoosePro2=translationChooseProgram.feedback)||void 0===_translationChoosePro2?void 0:_translationChoosePro2["connect-rigobot-text"])||t("feedback.connect-rigobot-text")," ",Feedback_jsx(chunk_YTV6DHKL.r,{href:"https://rigobot.herokuapp.com/invite/?referer=4Geeks&token=".concat(accessToken),color:"currentcolor",textDecoration:"underline",fontSize:"12px",variant:"default"},(null==translationChooseProgram||null===(_translationChoosePro3=translationChooseProgram.feedback)||void 0===_translationChoosePro3?void 0:_translationChoosePro3["connect-rigobot"])||t("feedback.connect-rigobot")),".")),Feedback_jsx(Text.Z,{size:"12px",textAlign:"center"},(null==translationChooseProgram||null===(_translationChoosePro4=translationChooseProgram.feedback)||void 0===_translationChoosePro4?void 0:_translationChoosePro4["why-feedback-text"])||t("feedback.why-feedback-text")," ",Feedback_jsx(chunk_YTV6DHKL.r,{fontSize:"12px",variant:"default",href:{en:"https://4geeks.com/mastering-technical-knowledge#feedback-quality-and-frequency",es:"https://4geeks.com/es/mastering-technical-knowledge#calidad-y-frecuencia-del-feedback"}[lang]},(null==translationChooseProgram||null===(_translationChoosePro5=translationChooseProgram.feedback)||void 0===_translationChoosePro5?void 0:_translationChoosePro5["learn-why"])||t("feedback.learn-why"),"."))),Feedback_jsx(chunk_MPFPK3CX.k,{flexDirection:"column",gridGap:"10px",padding:"12px 8px",maxHeight:"17rem",overflow:"auto"},(null==codeRevisions?void 0:codeRevisions.length)>0?codeRevisions.map((function(revision){var _revision$repository,_revision$repository2;return Feedback_jsx(chunk_MPFPK3CX.k,{gridGap:"8px",onClick:function onClick(){return function handleOpen(data){var _data$file,_data$file2,_data$file3,_data$file4,_data$file5,_data$file6,isFileCodeBase64=base64regex.test(null==data||null===(_data$file=data.file)||void 0===_data$file?void 0:_data$file.content),isReviewCodeBase64=base64regex.test(null==data?void 0:data.original_code),updatedCode=isFileCodeBase64?(0,utils.NV)(null==data||null===(_data$file2=data.file)||void 0===_data$file2?void 0:_data$file2.content):null==data||null===(_data$file3=data.file)||void 0===_data$file3?void 0:_data$file3.content,originalCode=isReviewCodeBase64?(0,utils.NV)(data.original_code):data.original_code;setSelectedData({code_revisions:codeRevisions,commitFile:Feedback_objectSpread(Feedback_objectSpread({},null==data?void 0:data.file),{},{path:null==data||null===(_data$file4=data.file)||void 0===_data$file4?void 0:_data$file4.name,url:null==data||null===(_data$file5=data.file)||void 0===_data$file5?void 0:_data$file5.file_url,name:null==data||null===(_data$file6=data.file)||void 0===_data$file6?void 0:_data$file6.name,code:originalCode}),revision_content:Feedback_objectSpread(Feedback_objectSpread({},data),{},{code:updatedCode})}),setIsOpen(!0)}(revision)},_hover:{background:featuredColor},cursor:"default",borderRadius:"11px",alignItems:"center",padding:"8px",border:"1px solid",borderColor:borderColor2},Feedback_jsx(chunk_MPFPK3CX.k,{gridGap:"16px",width:"100%",alignItems:"center"},Feedback_jsx(Icon.Z,{icon:"code-comment",color:hexColor.blueDefault,width:"24px",height:"24px",padding:"12px"}),Feedback_jsx(chunk_MPFPK3CX.k,{flexDirection:"column",gridGap:"5px"},Feedback_jsx(Heading.Z,{size:"12px",fontWeight:900},null!=revision&&null!==(_revision$repository=revision.repository)&&void 0!==_revision$repository&&_revision$repository.name?(0,utils.I4)(null==revision||null===(_revision$repository2=revision.repository)||void 0===_revision$repository2?void 0:_revision$repository2.name):t("feedback.code-review")),Feedback_jsx(Text.Z,{size:"12px",fontWeight:400,title:null==revision?void 0:revision.comment},(null==revision?void 0:revision.comment.length)>=40?"".concat(null==revision?void 0:revision.comment.slice(0,25),"..."):null==revision?void 0:revision.comment))),Feedback_jsx(Icon.Z,{icon:"arrowLeft",width:"13px",height:"10px",padding:"8px",style:{flexShrink:0,transform:"rotate(180deg)"}}))})):Feedback_jsx(AlertMessage.Z,{type:"info",withoutIcon:!0,background:featuredColor,border:"0px",iconColor:hexColor.black,color:"currentcolor",full:!0,fontSize:"12px",borderRadius:"4px",padding:"8px"},(null==translationChooseProgram||null===(_translationChoosePro6=translationChooseProgram.feedback)||void 0===_translationChoosePro6?void 0:_translationChoosePro6["no-code-reviews-text"])||t("feedback.no-code-reviews-text"))),Feedback_jsx(components_ReviewModal,{isExternal:!0,externalData:Feedback_objectSpread(Feedback_objectSpread({},selectedData),{},{translation:storybookTranslation}),isStudent:!0,defaultStage:"code_review",fixedStage:!0,isOpen,onClose:function onClose(){return setIsOpen(!1)}})))}Feedback.propTypes={storyConfig:prop_types_default().objectOf(prop_types_default().oneOfType([prop_types_default().string,prop_types_default().number,prop_types_default().bool,prop_types_default().array,prop_types_default().object]))},Feedback.defaultProps={storyConfig:null},Feedback.__docgenInfo={description:"",methods:[],displayName:"Feedback",props:{storyConfig:{defaultValue:{value:"null",computed:!1},description:"",type:{name:"objectOf",value:{name:"union",value:[{name:"string"},{name:"number"},{name:"bool"},{name:"array"},{name:"object"}]}},required:!1}}};const components_Feedback=Feedback;var _Default$parameters,_Default$parameters2,Feedback_stories_console=__webpack_require__("./node_modules/console-browserify/index.js"),Feedback_stories_jsx=react.createElement;function Feedback_stories_ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function Feedback_stories_objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?Feedback_stories_ownKeys(Object(t),!0).forEach((function(r){(0,defineProperty.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Feedback_stories_ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}const Feedback_stories={title:"Components/Feedback",component:components_Feedback,argTypes:{isAuthenticatedWithRigobot:{control:{type:"boolean"}},externalCodeRevisions:{control:{type:"object"}},storyConfig:{control:{type:"hidden"}}}};var Template=function Template(args){Feedback_stories_console.log("args",args);var isAuthenticatedWithRigobot=null==args?void 0:args.isAuthenticatedWithRigobot,externalCodeRevisions=null==args?void 0:args.externalCodeRevisions;return Feedback_stories_jsx(chunk_6CSUKJP7.xu,null,Feedback_stories_jsx(components_Feedback,{storyConfig:Feedback_stories_objectSpread(Feedback_stories_objectSpread({},args),{},{isAuthenticatedWithRigobot,externalCodeRevisions})}))};Template.displayName="Template";var Default=Template.bind({});Default.args={isAuthenticatedWithRigobot:!1,externalCodeRevisions:[{id:1,comment:"So bad your  c ode bro",original_code:'LASK_ENV # Imported from Heroku app\r\nvalue: production\r\n- key: FLASK_APP_KEY # Imported from Heroku app\r\nvalue: "any key works"\r\n- key: DATABASE_URL # Render PostgreSQL database\r\nfromDatabase:\r\nname: postgresql-trapezoidal-42170\r\nproperty: connectionString\r\n\r\ndatabases: # Render PostgreSQL database',committers:[{id:1,name:"Charlytoc",github_username:"charlytoc"}],reviewer:{id:2,name:"Charlytoc-132",username:"charlytoc-132@proton.me"},user_read_at:null,revision_rating:null,revision_rating_comments:null,file:{id:11,file_url:"https://api.github.com/repos/Charlytoc/where2day/contents/render.yaml?ref=ccac40dcebcc326c195c4a18ede6237ed23d78e8",content:'services:\n    - type: web # valid values: https://render.com/docs/yaml-spec#type\n      region: ohio\n      name: sample-service-name\n      env: python # valid values: https://render.com/docs/yaml-spec#environment\n      buildCommand: "./render_build.sh"\n      startCommand: "gunicorn wsgi --chdir ./src/"\n      plan: free # optional; defaults to starter\n      numInstances: 1\n      envVars:\n          - key: BASENAME # Imported from Heroku app\n            value: /\n          - key: FLASK_APP # Imported from Heroku app\n            value: src/app.py\n          - key: FLASK_ENV # Imported from Heroku app\n            value: production\n          - key: FLASK_APP_KEY # Imported from Heroku app\n            value: "any key works"\n          - key: DATABASE_URL # Render PostgreSQL database\n            fromDatabase:\n                name: postgresql-trapezoidal-42170\n                property: connectionString\n\ndatabases: # Render PostgreSQL database\n    - name: postgresql-trapezoidal-42170\n      region: ohio\n      ipAllowList: [] # only allow internal connections\n      plan: free # optional; defaults to starter\n',added_lines:'services:\n    - type: web # valid values: https://render.com/docs/yaml-spec#type\n      region: ohio\n      name: sample-service-name\n      env: python # valid values: https://render.com/docs/yaml-spec#environment\n      buildCommand: "./render_build.sh"\n      startCommand: "gunicorn wsgi --chdir ./src/"\n      plan: free # optional; defaults to starter\n      numInstances: 1\n      envVars:\n          - key: BASENAME # Imported from Heroku app\n            value: /\n          - key: FLASK_APP # Imported from Heroku app\n            value: src/app.py\n          - key: FLASK_ENV # Imported from Heroku app\n            value: production\n          - key: FLASK_APP_KEY # Imported from Heroku app\n            value: "any key works"\n          - key: DATABASE_URL # Render PostgreSQL database\n            fromDatabase:\n                name: postgresql-trapezoidal-42170\n                property: connectionString\n\ndatabases: # Render PostgreSQL database\n    - name: postgresql-trapezoidal-42170\n      region: ohio\n      ipAllowList: [] # only allow internal connections\n      plan: free # optional; defaults to starter',name:"render.yaml",language:"python"},created_at:"2023-05-30T17:54:35.040Z",updated_at:"2023-05-30T17:54:35.050Z",language:null,repository:{id:3,owner:"Charlytoc",name:"where2day",url:"https://github.com/Charlytoc/where2day"}},{id:2,comment:"Pretty ugly",original_code:'# Imported from Heroku app\r\nvalue: src/app.py\r\n- key: FLASK_ENV # Imported from Heroku app\r\nvalue: production\r\n- key: FLASK_APP_KEY # Imported from Heroku app\r\nvalue: "any key works"\r\n- key: DATABASE_URL # Render PostgreSQL database\r\nfromDatabase:\r\nname: postgresql-trapezoidal-42170',committers:[{id:1,name:"Charlytoc",github_username:"charlytoc"}],reviewer:{id:2,name:"Charlytoc-132",username:"charlytoc-132@proton.me"},user_read_at:null,revision_rating:null,revision_rating_comments:null,file:{id:11,file_url:"https://api.github.com/repos/Charlytoc/where2day/contents/render.yaml?ref=ccac40dcebcc326c195c4a18ede6237ed23d78e8",content:'services:\n    - type: web # valid values: https://render.com/docs/yaml-spec#type\n      region: ohio\n      name: sample-service-name\n      env: python # valid values: https://render.com/docs/yaml-spec#environment\n      buildCommand: "./render_build.sh"\n      startCommand: "gunicorn wsgi --chdir ./src/"\n      plan: free # optional; defaults to starter\n      numInstances: 1\n      envVars:\n          - key: BASENAME # Imported from Heroku app\n            value: /\n          - key: FLASK_APP # Imported from Heroku app\n            value: src/app.py\n          - key: FLASK_ENV # Imported from Heroku app\n            value: production\n          - key: FLASK_APP_KEY # Imported from Heroku app\n            value: "any key works"\n          - key: DATABASE_URL # Render PostgreSQL database\n            fromDatabase:\n                name: postgresql-trapezoidal-42170\n                property: connectionString\n\ndatabases: # Render PostgreSQL database\n    - name: postgresql-trapezoidal-42170\n      region: ohio\n      ipAllowList: [] # only allow internal connections\n      plan: free # optional; defaults to starter\n',added_lines:'services:\n    - type: web # valid values: https://render.com/docs/yaml-spec#type\n      region: ohio\n      name: sample-service-name\n      env: python # valid values: https://render.com/docs/yaml-spec#environment\n      buildCommand: "./render_build.sh"\n      startCommand: "gunicorn wsgi --chdir ./src/"\n      plan: free # optional; defaults to starter\n      numInstances: 1\n      envVars:\n          - key: BASENAME # Imported from Heroku app\n            value: /\n          - key: FLASK_APP # Imported from Heroku app\n            value: src/app.py\n          - key: FLASK_ENV # Imported from Heroku app\n            value: production\n          - key: FLASK_APP_KEY # Imported from Heroku app\n            value: "any key works"\n          - key: DATABASE_URL # Render PostgreSQL database\n            fromDatabase:\n                name: postgresql-trapezoidal-42170\n                property: connectionString\n\ndatabases: # Render PostgreSQL database\n    - name: postgresql-trapezoidal-42170\n      region: ohio\n      ipAllowList: [] # only allow internal connections\n      plan: free # optional; defaults to starter',name:"render.yaml",language:"python"},created_at:"2023-05-30T17:54:41.473Z",updated_at:"2023-05-30T17:54:41.478Z",language:null,repository:{id:3,owner:"Charlytoc",name:"where2day",url:"https://github.com/Charlytoc/where2day"}}]},Default.parameters=Feedback_stories_objectSpread(Feedback_stories_objectSpread({},Default.parameters),{},{docs:Feedback_stories_objectSpread(Feedback_stories_objectSpread({},null===(_Default$parameters=Default.parameters)||void 0===_Default$parameters?void 0:_Default$parameters.docs),{},{source:Feedback_stories_objectSpread({originalSource:"args => {\n  console.log('args', args);\n  const isAuthenticatedWithRigobot = args?.isAuthenticatedWithRigobot;\n  const externalCodeRevisions = args?.externalCodeRevisions;\n  return <Box>\n    <Feedback storyConfig={{\n      ...args,\n      isAuthenticatedWithRigobot,\n      externalCodeRevisions\n    }} />\n  </Box>;\n}"},null===(_Default$parameters2=Default.parameters)||void 0===_Default$parameters2||null===(_Default$parameters2=_Default$parameters2.docs)||void 0===_Default$parameters2?void 0:_Default$parameters2.source)})})},"./src/common/components/AlertMessage.jsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var _home_runner_work_breatheco_de_app_breatheco_de_app_node_modules_babel_runtime_helpers_esm_extends_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/extends.js"),_home_runner_work_breatheco_de_app_breatheco_de_app_node_modules_babel_runtime_helpers_esm_defineProperty_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),_home_runner_work_breatheco_de_app_breatheco_de_app_node_modules_babel_runtime_helpers_esm_objectWithoutProperties_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js"),react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),_chakra_ui_react__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@chakra-ui/layout/dist/chunk-6CSUKJP7.mjs"),prop_types__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/prop-types/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_9__),_Text__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/common/components/Text.jsx"),_Icon__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/common/components/Icon/index.jsx"),_hooks_useStyle__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./src/common/hooks/useStyle.js"),_Heading__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./src/common/components/Heading.jsx"),_excluded=["message","type","iconColor","withoutIcon","style","textStyle","full","textColor","dangerouslySetInnerHTML","title","children"],__jsx=react__WEBPACK_IMPORTED_MODULE_0__.createElement;function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach((function(r){(0,_home_runner_work_breatheco_de_app_breatheco_de_app_node_modules_babel_runtime_helpers_esm_defineProperty_js__WEBPACK_IMPORTED_MODULE_1__.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function AlertMessage(_ref){var message=_ref.message,type=_ref.type,iconColor=_ref.iconColor,withoutIcon=_ref.withoutIcon,style=_ref.style,textStyle=_ref.textStyle,full=_ref.full,textColor=_ref.textColor,dangerouslySetInnerHTML=_ref.dangerouslySetInnerHTML,title=_ref.title,children=_ref.children,rest=(0,_home_runner_work_breatheco_de_app_breatheco_de_app_node_modules_babel_runtime_helpers_esm_objectWithoutProperties_js__WEBPACK_IMPORTED_MODULE_5__.Z)(_ref,_excluded),fontColor=(0,_hooks_useStyle__WEBPACK_IMPORTED_MODULE_6__.Z)().fontColor,alertColors={soft:"#FFF4DC",warning:"#FFB718",success:"#25BF6C",error:"#dc3545",info:"#00A0E9"};return(message||children)&&__jsx(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_7__.xu,(0,_home_runner_work_breatheco_de_app_breatheco_de_app_node_modules_babel_runtime_helpers_esm_extends_js__WEBPACK_IMPORTED_MODULE_8__.Z)({display:"flex",style,flexDirection:"row",backgroundColor:full?alertColors[type]:"transparent",border:"2px solid",borderColor:alertColors[type],alignItems:"center",padding:"16px",borderRadius:"16px",gridGap:"16px"},rest),!withoutIcon&&__jsx(_Icon__WEBPACK_IMPORTED_MODULE_3__.Z,{icon:type,secondColor:rest.secondColor,color:iconColor||(full?"#000":""),props:{full:!0},style:{minWidth:"18px"},width:"18px",height:"18px"}),children&&children,!children&&__jsx(react__WEBPACK_IMPORTED_MODULE_0__.Fragment,null,__jsx(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_7__.xu,null,title&&__jsx(_Heading__WEBPACK_IMPORTED_MODULE_4__.Z,{size:"20px",letterSpacing:"0.02em",mb:"10px"},title),dangerouslySetInnerHTML?__jsx(_Text__WEBPACK_IMPORTED_MODULE_2__.Z,{fontSize:rest.fontSize||"15px",color:full?"black":textColor||fontColor,fontWeight:"500",style:_objectSpread(_objectSpread({},textStyle),{},{margin:"0"}),dangerouslySetInnerHTML:{__html:message}}):__jsx(_Text__WEBPACK_IMPORTED_MODULE_2__.Z,{fontSize:rest.fontSize||"15px",color:full?"black":textColor||fontColor,fontWeight:rest.fontWeight||"700",style:_objectSpread(_objectSpread({},textStyle),{},{margin:"0"})},message))))}AlertMessage.propTypes={message:prop_types__WEBPACK_IMPORTED_MODULE_9___default().oneOfType([prop_types__WEBPACK_IMPORTED_MODULE_9___default().string,prop_types__WEBPACK_IMPORTED_MODULE_9___default().node]),type:prop_types__WEBPACK_IMPORTED_MODULE_9___default().string,style:prop_types__WEBPACK_IMPORTED_MODULE_9___default().objectOf(prop_types__WEBPACK_IMPORTED_MODULE_9___default().oneOfType([prop_types__WEBPACK_IMPORTED_MODULE_9___default().any])),full:prop_types__WEBPACK_IMPORTED_MODULE_9___default().bool,textStyle:prop_types__WEBPACK_IMPORTED_MODULE_9___default().objectOf(prop_types__WEBPACK_IMPORTED_MODULE_9___default().oneOfType([prop_types__WEBPACK_IMPORTED_MODULE_9___default().any])),textColor:prop_types__WEBPACK_IMPORTED_MODULE_9___default().string,dangerouslySetInnerHTML:prop_types__WEBPACK_IMPORTED_MODULE_9___default().bool,title:prop_types__WEBPACK_IMPORTED_MODULE_9___default().string,children:prop_types__WEBPACK_IMPORTED_MODULE_9___default().node,withoutIcon:prop_types__WEBPACK_IMPORTED_MODULE_9___default().bool,iconColor:prop_types__WEBPACK_IMPORTED_MODULE_9___default().string},AlertMessage.defaultProps={message:"",type:"warning",style:{},full:!1,textStyle:{},textColor:"",dangerouslySetInnerHTML:!1,title:"",children:null,withoutIcon:!1,iconColor:""},AlertMessage.__docgenInfo={description:"",methods:[],displayName:"AlertMessage",props:{message:{defaultValue:{value:"''",computed:!1},description:"",type:{name:"union",value:[{name:"string"},{name:"node"}]},required:!1},type:{defaultValue:{value:"'warning'",computed:!1},description:"",type:{name:"string"},required:!1},style:{defaultValue:{value:"{}",computed:!1},description:"",type:{name:"objectOf",value:{name:"union",value:[{name:"any"}]}},required:!1},full:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},textStyle:{defaultValue:{value:"{}",computed:!1},description:"",type:{name:"objectOf",value:{name:"union",value:[{name:"any"}]}},required:!1},textColor:{defaultValue:{value:"''",computed:!1},description:"",type:{name:"string"},required:!1},dangerouslySetInnerHTML:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},title:{defaultValue:{value:"''",computed:!1},description:"",type:{name:"string"},required:!1},children:{defaultValue:{value:"null",computed:!1},description:"",type:{name:"node"},required:!1},withoutIcon:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},iconColor:{defaultValue:{value:"''",computed:!1},description:"",type:{name:"string"},required:!1}}};const __WEBPACK_DEFAULT_EXPORT__=AlertMessage},"./src/common/components/LoaderScreen.jsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var _home_runner_work_breatheco_de_app_breatheco_de_app_node_modules_babel_runtime_helpers_esm_extends_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/extends.js"),_home_runner_work_breatheco_de_app_breatheco_de_app_node_modules_babel_runtime_helpers_esm_objectWithoutProperties_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js"),react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),_chakra_ui_react__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@chakra-ui/layout/dist/chunk-6CSUKJP7.mjs"),_chakra_ui_react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@chakra-ui/image/dist/chunk-E3YVMML4.mjs"),prop_types__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/prop-types/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_6__),_hooks_useStyle__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/common/hooks/useStyle.js"),_excluded=["width","height","objectFit"],__jsx=react__WEBPACK_IMPORTED_MODULE_0__.createElement;function LoaderScreen(_ref){var width=_ref.width,height=_ref.height,objectFit=_ref.objectFit,rest=(0,_home_runner_work_breatheco_de_app_breatheco_de_app_node_modules_babel_runtime_helpers_esm_objectWithoutProperties_js__WEBPACK_IMPORTED_MODULE_1__.Z)(_ref,_excluded),backgroundColor=(0,_hooks_useStyle__WEBPACK_IMPORTED_MODULE_2__.Z)().backgroundColor;return __jsx(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_3__.xu,(0,_home_runner_work_breatheco_de_app_breatheco_de_app_node_modules_babel_runtime_helpers_esm_extends_js__WEBPACK_IMPORTED_MODULE_4__.Z)({display:"flex",alignItems:"center",position:"absolute",background:backgroundColor,justifyContent:"center",width:"100%",height:"100%",style:{zIndex:50},top:"0px",left:"0px"},rest),__jsx(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_5__.E,{src:"/static/images/loader.gif",width,height,objectFit,alt:"loader"}))}LoaderScreen.displayName="LoaderScreen",LoaderScreen.propTypes={width:prop_types__WEBPACK_IMPORTED_MODULE_6___default().string,height:prop_types__WEBPACK_IMPORTED_MODULE_6___default().string,objectFit:prop_types__WEBPACK_IMPORTED_MODULE_6___default().string},LoaderScreen.defaultProps={width:"200px",height:"200px",objectFit:"cover"},LoaderScreen.__docgenInfo={description:"",methods:[],displayName:"LoaderScreen",props:{width:{defaultValue:{value:"'200px'",computed:!1},description:"",type:{name:"string"},required:!1},height:{defaultValue:{value:"'200px'",computed:!1},description:"",type:{name:"string"},required:!1},objectFit:{defaultValue:{value:"'cover'",computed:!1},description:"",type:{name:"string"},required:!1}}};const __WEBPACK_DEFAULT_EXPORT__=LoaderScreen}}]);